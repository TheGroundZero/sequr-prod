<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-US lang=en-US><head><title itemprop=name>Intro into Shelly :: Sequr</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=robots content="noodp, noydir"><meta name=googlebot content="noodp, noydir"><meta name=url content="https://sequr.be/blog/2020/07/intro-into-shelly/" itemprop=url><link rel=icon href=/favicon.ico><meta itemprop=name content="Intro into Shelly"><meta itemprop=description content="Join my adventure in the world of home automation, starting with the Shelly devices."><meta itemprop=datePublished content="2020-07-24T00:00:00+02:00"><meta itemprop=dateModified content="2021-11-06T00:00:00+01:00"><meta itemprop=wordCount content="3323"><meta itemprop=image content="https://sequr.be/blog/2020/07/intro-into-shelly/cover.svg"><meta itemprop=keywords content="Home,Automation,Shelly,Introduction"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sequr.be/blog/2020/07/intro-into-shelly/cover.svg"><meta name=twitter:title content="Intro into Shelly"><meta name=twitter:description content="Join my adventure in the world of home automation, starting with the Shelly devices."><meta property="og:url" content="https://sequr.be/blog/2020/07/intro-into-shelly/"><meta property="og:site_name" content="Sequr"><meta property="og:title" content="Intro into Shelly"><meta property="og:description" content="Join my adventure in the world of home automation, starting with the Shelly devices."><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2020-07-24T00:00:00+02:00"><meta property="article:modified_time" content="2021-11-06T00:00:00+01:00"><meta property="article:tag" content="Home"><meta property="article:tag" content="Automation"><meta property="article:tag" content="Shelly"><meta property="article:tag" content="Introduction"><meta property="og:image" content="https://sequr.be/blog/2020/07/intro-into-shelly/cover.svg"><meta name=description content="Join my adventure in the world of home automation, starting with the Shelly devices."><meta property="og:updated_time" content="2021-11-06T00:00:00+01:00"><link rel=sitemap type=application/xml title=Sitemap href=https://sequr.be/sitemap.xml><link rel=alternate type=text/mf2+html href=https://sequr.be/><meta name=apple-mobile-web-app-title content="Intro into Shelly"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><link rel=webmention href=https://webmention.io/sequr.be/webmention><link rel=stylesheet href=/css/bundle.min.308a714c50df5143bc08878001fede0511b3f9022c4c129848a3643270ab2f10.css integrity="sha256-MIpxTFDfUUO8CIeAAf7eBRGz+QIsTBKYSKNkMnCrLxA=" crossorigin=anonymous><script defer type=text/javascript src=/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js integrity="sha256-FFRTJhp3VfUEKoVMQhNQHSFaj740wI0YHED4A/ExXnQ=" crossorigin=anonymous></script></head><body class=dark-theme><div class=wrapper><aside class="sidebar h-card background-image"><div class="container sidebar-sticky"><div class=light-dark align=right><button class=btn-light-dark title="Toggle light/dark mode"><svg class="moon" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/></svg><svg class="sun" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg></button></div><div class="sidebar-about hcard"><h1 class=brand><a href=https://sequr.be/><img src=/logo.png class="u-logo u-photo" alt="Sequr brand image">
</a><a href=https://sequr.be/ class="u-url p-org"><h1>Sequr</h1></a></h1><p class="lead p-note">Writeups and random stuff about infosec and life</p></div><nav><ul class=sidebar-nav><li class=heading><a href=/about/ title=About>About</a></li><li class=heading><a href=/blog/ title=Blog>Blog</a></li><li class=sub-heading>Recent</li><li class=bullet><a href=/blog/2025/02/flashing-the-sonoff-powr3-with-tasmota/ title="Flashing the Sonoff POWR3 with Tasmota" hreflang=en>Tasmota on Sonoff POWR3</a></li><li class=bullet><a href=/blog/2025/01/sending-my-first-webmention-from-scratch/ title="Sending my first webmention from scratch" hreflang=en>My first Webmention</a></li><li class=bullet><a href=/blog/2025/01/bridging-this-blog-with-the-fediverse/ title="Bridging this blog with the Fediverse" hreflang=en>Briding with the Fediverse</a></li><li class=heading><a href=/shoppinglist/ title=Shopping>Shopping</a></li><li class=heading><a href=/privacy/ title=Privacy>Privacy</a></li></ul></nav><a target=_blank class=social title="Atom Feed" href=/atom.xml><svg width="1em" height="1.2em" viewBox="0 0 1280 1280"><g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentcolor"><path d="M2295 11929c-284-12-642-45-707-65-17-5-18-63-18-1039 0-569 4-1036 8-1039 5-3 74 6 153 19 510 86 1168 95 1789 25 1348-153 2602-677 3670-1531 385-308 820-744 1126-1129 842-1060 1362-2313 1514-3650 70-621 61-1279-25-1789-13-79-22-148-19-153 3-4 471-8 1039-8h1035l5 23c51 225 85 942 67 1419-23 605-77 1044-198 1617-294 14e2-927 2734-1823 3846-1043 1295-2364 2259-3909 2854-1158 447-2451 656-3707 6e2z"/><path d="M2255 7845c-269-25-620-81-667-106-17-9-18-55-18-899 0-706 3-890 13-890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207-107 2267-823 2814-1902 166-327 268-637 330-1001 38-227 48-384 42-662-8-348-44-590-126-831-23-66-41-126-41-132 0-10 184-13 890-13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782-59 703-233 1323-545 1945-481 956-1313 1788-2270 2268-620 310-1239 483-1940 542-165 14-669 10-840-5z"/><path d="M2519 3815c-391-66-725-336-868-703-79-201-96-462-45-677 83-344 338-641 666-774 116-47 205-69 330-80 412-39 811 153 1040 5e2 193 292 240 648 128 981-135 403-492 699-914 757-1e2 14-241 12-337-4z"/></g></svg></a><a href=https://bsky.app/profile/sequr.be target=_blank class="u-url social" rel="external noopener me" title=Bluesky><svg width="1.2em" height="1.2em" viewBox="0 0 568 501"><path fill="currentcolor" d="M123.121 33.6637C188.241 82.5526 258.281 181.681 284 234.873c25.719-53.192 95.759-152.3204 160.879-201.2093C491.866-1.61183 568-28.9064 568 57.9464 568 75.2916 558.055 203.659 552.222 224.501c-20.275 72.453-94.155 90.933-159.875 79.748C507.222 323.8 536.444 388.56 473.333 453.32c-119.86 122.992-172.272-30.859-185.702-70.281C285.169 375.812 284.017 372.431 284 375.306 283.983 372.431 282.831 375.812 280.369 383.039c-13.43 39.422-65.842 193.273-185.7023 70.281C31.5556 388.56 60.7778 323.8 175.653 304.249 109.933 315.434 36.0535 296.954 15.7778 224.501 9.94525 203.659.0 75.2916.0 57.9464.0-28.9064 76.1345-1.61183 123.121 33.6637z"/></svg></a><a href=https://mastodon-belgium.be/@TerraGloba target=_blank class="u-url social" rel="external noopener me" title=Mastodon>
<svg width="1.2em" height="1.2em" viewBox="0 0 24 24"><path fill="currentcolor" d="M20.94 14c-.28 1.41-2.44 2.96-4.97 3.26-1.31.15-2.6.3-3.97.24-2.25-.11-4-.54-4-.54v.62c.32 2.22 2.22 2.35 4.03 2.42 1.82.05 3.44-.46 3.44-.46l.08 1.65s-1.28.68-3.55.81c-1.25.07-2.81-.03-4.62-.5-3.92-1.05-4.6-5.24-4.7-9.5l-.01-3.43c0-4.34 2.83-5.61 2.83-5.61C6.95 2.3 9.41 2 11.97 2h.06c2.56.0 5.02.3 6.47.96.0.0 2.83 1.27 2.83 5.61.0.0.04 3.21-.39 5.43M18 8.91c0-1.08-.3-1.91-.85-2.56-.56-.63-1.3-.96-2.23-.96-1.06.0-1.87.41-2.42 1.23l-.5.88-.5-.88c-.56-.82-1.36-1.23-2.43-1.23-.92.0-1.66.33-2.23.96C6.29 7 6 7.83 6 8.91v5.26h2.1V9.06c0-1.06.45-1.62 1.36-1.62 1 0 1.5.65 1.5 1.93v2.79h2.07V9.37c0-1.28.5-1.93 1.51-1.93.9.0 1.35.56 1.35 1.62v5.11H18V8.91z"/></svg></a><a href=https://github.com/TheGroundZero target=_blank class="u-url social" rel="external noopener me" title=Github><svg width="1.2em" height="1.2em" viewBox="-2 -2 24 24"><path fill="currentcolor" d="M18.88 1.099C18.147.366 17.265.0 16.233.0H3.746C2.714.0 1.832.366 1.099 1.099.366 1.832.0 2.714.0 3.746v12.487c0 1.032.366 1.914 1.099 2.647.733.733 1.615 1.099 2.647 1.099H6.66c.19.0.333-.007.429-.02a.504.504.0 00.286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555.0 01-.904-.091 2.026 2.026.0 01-.872-.39 1.651 1.651.0 01-.572-.8l-.13-.3a3.25 3.25.0 00-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956.0 01-.17-.156.723.723.0 01-.117-.182c-.026-.061-.004-.111.065-.15.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1.0 01.631.677c.2.355.44.626.722.813.282.186.566.28.852.28.286.0.533-.022.742-.065a2.59 2.59.0 00.585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907.0 01-1.333-.234 5.314 5.314.0 01-1.223-.507 3.5 3.5.0 01-1.047-.872c-.277-.347-.505-.802-.683-1.365-.177-.564-.266-1.215-.266-1.952.0-1.049.342-1.942 1.027-2.68-.32-.788-.29-1.673.091-2.652.252-.079.625-.02 1.119.175.494.195.856.362 1.086.5.23.14.414.257.553.352a9.233 9.233.0 012.497-.338c.859.0 1.691.113 2.498.338l.494-.312a6.997 6.997.0 011.197-.572c.46-.174.81-.221 1.054-.143.39.98.424 1.864.103 2.653.685.737 1.028 1.63 1.028 2.68.0.737-.089 1.39-.267 1.957-.177.568-.407 1.023-.689 1.366a3.65 3.65.0 01-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9.0 01-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36.0 00.208.189c.096.034.18.056.254.064.074.01.18.013.318.013h2.914c1.032.0 1.914-.366 2.647-1.099.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/></svg></a><a href=https://twitter.com/DezeStijn target=_blank class="u-url social" rel="external noopener me" title=Twitter><svg width="1.2em" height="1.2em" viewBox="0 0 16 16"><path fill="currentcolor" d="M5.032 14.286c6.037.0 9.34-4.837 9.34-9.032.0-.137.0-.274-.01-.41A6.56 6.56.0 0016 3.2c-.6.256-1.235.425-1.885.5a3.207 3.207.0 001.443-1.757c-.645.37-1.35.63-2.085.77a3.322 3.322.0 00-1.862-.958 3.384 3.384.0 00-2.082.334 3.223 3.223.0 00-1.442 1.49 3.08 3.08.0 00-.208 2.03 9.57 9.57.0 01-3.747-.963A9.269 9.269.0 011.114 2.292a3.086 3.086.0 00-.36 2.314c.189.787.68 1.475 1.376 1.924A3.344 3.344.0 01.64 6.132v.04c0 .734.263 1.444.743 2.01a3.3 3.3.0 001.89 1.102c-.483.128-.99.146-1.482.055a3.19 3.19.0 001.168 1.577 3.36 3.36.0 001.9.627A6.732 6.732.0 010 12.86a9.527 9.527.0 005.032 1.423"/></svg></a><a href=https://ko-fi.com/s4squatch target=_blank class="u-url social" rel="external noopener" title=Kofi><svg width="1.2em" height="1.2em" viewBox="0 0 24 24"><path fill="currentcolor" d="M23.881 8.948c-.773-4.085-4.859-4.593-4.859-4.593H.723c-.604.0-.679.798-.679.798s-.082 7.324-.022 11.822c.164 2.424 2.586 2.672 2.586 2.672s8.267-.023 11.966-.049c2.438-.426 2.683-2.566 2.658-3.734 4.352.24 7.422-2.831 6.649-6.916zm-11.062 3.511c-1.246 1.453-4.011 3.976-4.011 3.976s-.121.119-.31.023c-.076-.057-.108-.09-.108-.09-.443-.441-3.368-3.049-4.034-3.954-.709-.965-1.041-2.7-.091-3.71.951-1.01 3.005-1.086 4.363.407.0.0 1.565-1.782 3.468-.963 1.904.82 1.832 3.011.723 4.311zm6.173.478c-.928.116-1.682.028-1.682.028V7.284h1.77s1.971.551 1.971 2.638c0 1.913-.985 2.667-2.059 3.015z"/></svg></a><p class=footnote>&copy; 2019
• <a class="p-name u-url" href=https://sequr.be>Sequr</a>
• <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank rel="external noopener">CC BY-NC-SA 4.0</a></p><a href=https://sequr.be/en hreflang=en-US title=English class=u-translation-of rel=alternate><span class="flag fi fi-gb"></span>
</a><a href=https://sequr.be/nl hreflang=nl-BE title=Nederlands class=u-translation-of rel=alternate><span class="flag fi fi-nl"></span></a></div></aside><section class="content container"><article class="post h-entry"><header class=info><h1 class=post-title><a href=https://sequr.be/blog/2020/07/intro-into-shelly/ class="p-name u-url" rel=bookmark>Intro into Shelly</a></h1><div class=headline><div><span class="h-card p-author">DezeStijn</span><span class=whitespace> • </span><time datetime=2020-07-24T00:00:00+0200 class="post-date dt-published">Jul 24, 2020</time><span class=whitespace> </span><time datetime=2021-11-06T00:00:00+0100 class="post-date dt-updated">(Nov 6, 2021)
</time><span class=whitespace>• </span><span class=reading-time><span>16 mins read</span></span></div><ul class=tags><li class="tag-Home Automation"><a class=p-category href=https://sequr.be/categories/home-automation>Home Automation</a></li><li class=tag-Shelly><a class=p-category href=https://sequr.be/categories/shelly>Shelly</a></li></ul></div></header><main class=e-content><h2 id=intro>Intro</h2><p>The house I live in was build in the &rsquo;80s.
This means the configuration of the electrical installation is pretty basic and could sometimes be called old-fashioned.<br>This also means that the house has no provisions for the fancy home automation systems new houses often have included from the start.</p><p>Since adding these fancy systems in a house like mine would require me to basically strip and rewire the whole house &ndash;which I don&rsquo;t feel like doing&ndash;
I have to resort to home automation add-ons.<br>Luckily, there&rsquo;s already a whole market of devices that can assist in setting up home automation in situations like mine.
They&rsquo;re easily recognisable, since they&rsquo;re usually called <em>&ldquo;smart&rdquo;</em> + <em>&ldquo;non-smart device name&rdquo;</em>, like <em>&ldquo;smart toaster&rdquo;</em>.</p><p>I didn&rsquo;t feel much excitement for the first wave of smart device and I also have my doubts about the need to <em>smartify</em> just about anything,
especially the apparent need to connect just about anything to the internet.<br>If you want to have a laugh(?) at the things manufacturers add internet connectivity to, have a look at the Twitter profile <a href=https://twitter.com/internetofshit title="@internetofshit on Twitter" rel=external target=_blank>Internet of Shit</a>.</p><h2 id=requirements>Requirements</h2><p>The first rule of automation is that it should add functionality without adding extra burden.<br>For example: with most smart light bulbs, you cannot use your classical light switches anymore, since the bulbs require constant power.
As such, you&rsquo;ll either need to always use an app to turn on/off your lights, or buy <em>smart</em> light switches for manual control.</p><p>I definitely don&rsquo;t want to get vendor-locked.
Devices should be able to work with devices from other brands.
Preferably, 1 central hub should be able to control different devices and I should be able to set up automations across them.</p><p>Related to the previous requirement, I prefer to use open standards.<br>E.g., my security cameras work with ONVIF, so I can capture a copy of the video stream to my local NAS or control them using open software.</p><p>Devices shouldn&rsquo;t require internet connectivity to work.<br>If network access is require, e.g. for remote access from my smartphone, this should go through the central hub.
All other devices should be behind a firewall rule blocking outgoing connections.
Definitely no <a href=https://en.wikipedia.org/wiki/Universal_Plug_and_Play title="Universal Plug and Play, Wikipedia" rel=external target=_blank>UPnP</a> opening random ports on my FW.</p><p>Of course I want to be able to install everything myself.
Unless there&rsquo;s a high amount of risk involved or there&rsquo;s specific code to be followed, I want to do all installations on my own.
I feel comfortable opening switches and wall sockets, know the basics of electricity and safety, and have friends who I&rsquo;m able to call for advice if I have specific doubts.<br>An active support forum is definitely useful.</p><p>Since I don&rsquo;t have much experience (yet) with building devices myself, flashing firmware on ESP chips, etc. I want to be able to build prebuild devices.
But as I said before: I don&rsquo;t want blackbox devices with zero room for tinkering.</p><p>Updates are important.<br>In just about any device, tool, software package&mldr; bugs are discovered, some more dangerous or more impactful than others.<br>It&rsquo;s gives comfort knowing that the manufacturer still supports the devices and provides updates, be it Over the Air (OTA) or by manually flashing new packages.</p><p>Finally, I also want to be sure that my devices stay working in the future.<br>I&rsquo;m one of the many owners of a Pebble watch and am grateful for the developers and community continuing the <a href=https://rebble.io/ title="Rebble - Bring life back to your Pebble" rel=external target=_blank>project</a> after Fitbit <a href=https://web.archive.org/web/20180705003113/https://blog.getpebble.com/2016/12/07/fitbit/ title="Pebble’s Next Step" rel=external target=_blank>bought and killed</a> the Kickstarter backed smartwatch.</p><h2 id=introducing-shelly>Introducing: Shelly</h2><p>Saying that the devices of <a href=https://shelly.cloud title=Shelly rel=external target=_blank>Shelly</a> are the first introduction of <em>smartness</em> to my house, would be incorrect.<br>I already own a smart doorbell and perhaps you could almost call security cams managed by my NAS smart as well.<br>However, since I wasn&rsquo;t doing anything particularly smart with them yet, other than answering the door while at work, I won&rsquo;t count these in just yet.</p><p>Shelly devices are manufactured by Allterco, which has its headquarters in Sofia, Bulgaria.<br>By the looks of it, Shelly emerged around 2018 and has quickly risen in popularity.<br>It&rsquo;s usually compared to Sonoff, with the Shelly1 being matched with the Sonoff Basic.
If you want a comparison between these two devices, I would advise you to watch <a href="https://www.youtube.com/watch?v=J20hxfUTP9I" title="Is the Shelly 1 better than the Sonoff Basic?" rel=external target=_blank>this Youtube video</a> by The Hook Up.
In short, the Shelly relays (they have other devices as well) are small devices (the size of 2 Oreo cookies stacked on top of each other)
that are usually installed in a switch box and can be controlled via a physical switch or button, via the app,
or home automatation software like <a href=https://www.home-assistant.io/ title="Home Assistant" rel=external target=_blank>Home Assistant</a> (which I&rsquo;ll cover in another blog post).</p><figure class=center><img src=shelly1_cookie.jpg alt="Shelly compared to Oreo cookies"><figcaption class=center>© Shelly Cloud - Shelly 1 compared to Oreo cookies</figcaption></figure><p>I installed 3 Shelly devices in my house so far, one Shelly 1PM and two Shelly 2.5&rsquo;s, and plan on installing more in the future.
These currently control the light in one bedroom and two lights in my living room.</p><h2 id=installation>Installation</h2><blockquote><p><strong>WARNING</strong><br>Mains voltage can kill you!<br>Always turn off the breaker.<br>Ask an electrician for help if you don&rsquo;t know what to do.</p></blockquote><p>There are multiple types of Shelly relays. Which one you&rsquo;ll use depends on the type of load your switching and the specifics of your configuration.</p><p>Installation usually boils down to the following:</p><ul><li>The Shelly relay should be installed as close as possible (electrically speaking) to the load you&rsquo;re switching.<br>I.e. You&rsquo;ll probably install it behind the last switch in a multi-switch configuration, or in the lamp base.</li><li>You&rsquo;ll need to power the Shelly itself using mains voltage (110-230V AC) or using a power supply (12V/24-60V DC*).<br>For this you&rsquo;ll need connectors <strong>L</strong> (phase/-) and <strong>N</strong> (neutral/+).<br>Don&rsquo;t forget to set the jumper on the correct pins. By default, the jumper is set to power the Shelly with mains voltage.</li><li>The Live wire doesn&rsquo;t necessarily need to come off the same wire feeding the switches (SW), but it must be on the same phase.<br>Note that the Shelly and lamp will be protected by the breaker feeding the Shelly, so this may change if you <em>borrow</em> a wire elsewhere.</li><li>The Shelly 1 has a dry relay, which means that you can switch a load with a different voltage than what you&rsquo;re using to power the Shelly.<br>That&rsquo;s why, for the Shelly1, you&rsquo;ll also need to provide input voltage on connector <strong>I</strong> (input).<br>The other relays have the Input internally connected to the Live connector.</li><li>Connect your physical switch/button to the <strong>SW</strong> connector.
This could be the light switch of your existing light fixture.<br>This needs to be the same voltage as what you&rsquo;re providing to the Input connector (Shelly 1) or the Live connector (other Shelly relays).
Make sure you&rsquo;re not mixing phases if you&rsquo;re pulling wires from different circuits.</li><li>Whatever you&rsquo;re switching (e.g. your lights) will be connected to the <strong>O</strong> connector (Output).<br>You could have a Shelly relay at your switch just to detect input changes (I) and perhaps have a Shelly elsewhere to do the actual switching (O).</li></ul><p>* DC voltage may differ depending on the Shelly model. Make sure you check the manual first!</p><p>Make sure you follow your local code/regulations regarding type of cable used, colour coding, water/fire proofing, safety, etc.<br>For example: where I live, the most commonly used wires are the 1.5mm² and 2.5mm² used for lighting and wall sockets respectively.
Wires are coloured brown/red* for Phase/Live/Hot (I&rsquo;ll call this Live from now on), blue for Neutral, green-yellow for Ground, and black/grey for switch wires.
Since local building code has changed since my house was built, other colours might still be present, which is something to be wary of when working in older houses.</p><p>* Actually, any colour other than green-yellow may be used for Live. Even blue is allowed in a multi-phase layout where there&rsquo;s no Neutral.
Old houses over here often have white wires for Live.</p><p>However, I&rsquo;m not an electrician, building codes differ amongst countries/states/&mldr;, and they change over time (e.g., to accomodate for home automation systems), so:<br><strong>Always check your local building code and regulations! Consult a licensed electrician if you have any questions!</strong></p><figure class=center><img src=shelly1_wiring_ac.jpg alt="Shelly 1 wiring instructions"><figcaption class=center>© Shelly Cloud - Shelly 1 wiring instructions on mains</figcaption></figure><p>When you&rsquo;ve double-checked your wiring, turn on the breaker to power the Shelly and continue in the Shelly app for the initial configuration.</p><p>Info on the &ldquo;basic&rdquo; installations can be found in the Shelly manual or on the website.<br>These assume you have all the wires you need present at the location you want to install the Shelly relay.</p><h3 id=powering-the-shelly>Powering the Shelly</h3><p>As I discussed a few lines up, the Shelly needs to be powered as well.<br>But what if you don&rsquo;t have power available at the location you&rsquo;ll be installing the Shelly?</p><p>Depending on what you have available, you might still be able to get your automation going.</p><ul><li>Do you have the possibility to get power to that location?<ul><li>By pulling extra wires from the power source of your load (most commonly near the first switch in a multi-switch layout).</li><li>By <em>borrowing</em> power elsewhere. E.g. a wall socket or switch from a different room.<br>Do pay attention to the phases and keep in mind that this may cause your load to be connected to a different breaker than before.</li></ul></li><li>Can you reuse some of the wires already present?<ul><li>In a multi-switch layout, you&rsquo;ll have 2 switch wires between each switch. You could use these to carry power.<ul><li>If you have Neutral available at your load, you&rsquo;ll only need to transfer Live/Phase and have 1 cable available for SW.</li><li>If you don&rsquo;t, you&rsquo;ll have to use them for both Live and Neutral. I&rsquo;ll cover how to get SW to work later.</li></ul></li></ul></li></ul><p><strong>Tip!</strong>
You may want to do the initial configuration of the Shelly device on your workbench first.
Just in case anything goes wrong or you happen to have a broken device, you don&rsquo;t want to have to undo the whole installation of the Shelly again.</p><h3 id=shelly-configuration>Shelly configuration</h3><p>There&rsquo;s 2 methods of setting the Shelly up:</p><ul><li>using the Shelly app</li><li>using the <a href=/blog/2021/01/shelly-web-ui-method/ title="Shelly Web UI method">Web UI</a></li></ul><p>Both methods have their pros and cons, I leave it up to you to pick which method you prefer.</p><h2 id=examples>Examples</h2><h3 id=two-way-toggle-switch-with-shelly1pm>Two-way toggle switch with Shelly1(PM)</h3><p>Below is the most common installation of a 2-way switch, also known as a hotel switch.
Two switches control the same light and physical state of the switch (up/down) is not linked to the state of the lamp.</p><a href=schematic-2way.svg title="Wiring schematic of 2-way toggle switch" target=_blank><figure class=center><img src=schematic-2way.svg alt="Wiring schematic of 2-way toggle switch"><figcaption class=center>Wiring schematic of 2-way toggle switch</figcaption></figure></a><p>By installing a Shelly1(PM) you can make these switches &ldquo;smart&rdquo;.<br>Install the Shelly as below and set Button Mode to <em>Edge</em>.</p><a href=schematic-2way-shelly.svg title="Wiring schematic of 2-way toggle switch with Shelly1" target=_blank><figure class=center><img src=schematic-2way-shelly.svg alt="Wiring schematic of 2-way toggle switch with Shelly1"><figcaption class=center>Wiring schematic of 2-way toggle switch with Shelly1</figcaption></figure></a><p>Note that you need to pull an extra wire to be able to provide permanent Live to the Shelly.</p><h3 id=two-way-momentary-switch-with-shelly1pm>Two-way momentary switch with Shelly1(PM)</h3><p>A two-way setup can also be achieved using momentary switches.
A momentary switch setup is also ideal for when you want to make a toggle switch setup <em>smart</em> using a Shelly
since you can install the switches in parallel so that you don&rsquo;t need to pull an extra Live wire.</p><p>Extra switches would be installed in parallel, requiring only 2 wires: Live and signal.</p><a href=schematic-2way-momentary.svg title="Wiring schematic of 2-way momentary switch without relay module" target=_blank><figure class=center><img src=schematic-2way-momentary.svg alt="Wiring schematic of 2-way momentary switch without relay module"><figcaption class=center>Wiring schematic of 2-way momentary switch without relay module</figcaption></figure></a><p>Momentary switches send a pulse when they are pressed.
That&rsquo;s why they are always connected to some sort of relay unit which will toggle a relay each time a pulse is received.
Without the Shelly (or a different relay unit) the light would only be on while one of the buttons is being pressed.</p><p>Installing the Shelly will usually involve replacing the existing relay module with the Shelly.</p><a href=schematic-2way-momentary-shelly.svg title="Wiring schematic of 2-way momentary switch with Shelly1" target=_blank><figure class=center><img src=schematic-2way-momentary-shelly.svg alt="Wiring schematic of 2-way momentary switch with Shelly1"><figcaption class=center>Wiring schematic of 2-way momentary switch with Shelly1</figcaption></figure></a><h3 id=two-way-switch-renovation>Two-way switch, renovation</h3><p>My first install of a Shelly relay was in a bedroom I was renovating at that time.<br>The bedroom initially had one light switch at the door, but none near the bed.
So you either had to get in bed in the dark, or throw a shoe at the switch :P</p><p>While renovating, I got rid of the single switch and installed two two-way switches.<br>The Engineering Mindset has a good <a href="https://www.youtube.com/watch?v=opoEswRp_jg" title="The Engineer Mindset - Two Way Switching Explained - How to wire 2 way light switch" rel=external target=_blank>video</a> on how a two-way switch works.</p><p>In the old configuration, 3 wires would run from the switch to the lamp: Ground, Neutral and Live interrupted by the switch.</p><a href=schematic-lamp-1switch.svg title="Wiring schematic of lamp with single switch" target=_blank><figure class=center><img src=schematic-lamp-1switch.svg alt="Wiring schematic of lamp with single switch"><figcaption class=center>Schematic of old situation with single switch</figcaption></figure></a><p>To convert this into a two-way switch, I need to pull 2 (switch) wires between the switches and a Live wire from the second switch to the lamp.<br>Note that the old Live wire is no longer used. If you plan on installing a wall socket near the switch, you could still use that wire.
But make sure that you need to follow your local code re. mixing circuits.</p><a href=schematic-lamp-2switch.svg title="Wiring schematic of lamp with two-way switch" target=_blank><figure class=center><img src=schematic-lamp-2switch.svg alt="Wiring schematic of lamp with two-way switch"><figcaption class=center>Schematic of new situation with two-way switch</figcaption></figure></a><p>To install the Shelly, we&rsquo;ll reuse the old Live wire. By connecting this in front of the switch, it becomes a &ldquo;permanent Live&rdquo;.<br>We use this wire and the Neutral to power the Shelly. The Live is also used as the Input.<br>The output Live wire of the final switch is connected to the SW input.<br>Finally, the lamp is connected to the Output.<br>Note: use Wago clamps to connect multiple wires together.</p><a href=schematic-lamp-2switch-shelly.svg title="Wiring schematic of lamp with two-way switch and Shelly 1" target=_blank><figure class=center><img src=schematic-lamp-2switch-shelly.svg alt="Wiring schematic of lamp with two-way switch and Shelly 1"><figcaption class=center>Schematic two-way switch installation with Shelly 1</figcaption></figure></a><h3 id=two-way-switch-existing-installation>Two-way switch, existing installation</h3><p>I did my second Shelly installation in my living room.<br>In this room I have 2 switches at either side of the room to control 2 lights, so two sets of 2-way switches (a.k.a. 3-way or hotel-switch).</p><p>Since I cannot pull any extra wires to either switches or to the lights, I have to do with what&rsquo;s already there.<br>Luckily, at both locations I had access to permanent Live and Neutral, so I only need to take care of the switches and the output.</p><p>There&rsquo;s multiple ways you can get this to work:</p><h4 id=a-using-buttons>a) Using buttons</h4><p>The easiest setup would be to replace the switches with buttons (momentary switches).<br>Install a Shelly 2.5 at the final switch and use the switch wires to send the signal for each button.<br>Use a Wago to combine these wires with the wires connected to the matching buttons on the other side and run a wire to SW1 and SW2 respectively.</p><a href=schematic-2way-button-sh25.svg title="Wiring double 2-way momentary switch (buttons) with a Shelly 2.5" target=_blank><figure class=center><img src=schematic-2way-button-sh25.svg alt="Wiring double 2-way momentary switch (buttons) with a Shelly 2.5"><figcaption class=center>Wiring double 2-way momentary switch (buttons) with a Shelly 2.5</figcaption></figure></a><h4 id=b-using-shelly-25-and-shelly-i3>b) Using Shelly 2.5 and Shelly i3</h4><p>You could also install a Shelly i3 behind the first switch, using 2 of its 3 inputs.<br>Install a Shelly2.5 behind the final switch and connect the switches/buttons to SW1 and SW2.<br>Use the Actions menu on the Shelly i3 to toggle the outputs on the Shelly 2.5 using the HTTP REST API.<br>I.e., to toggle O1 use the following URL <code>http://&lt;IP_of_Shelly_2.5>/relay/0?turn=toggle</code></p><p>The diagram can be found a bit lower in the blog post.</p><h4 id=c-using-two-shelly-25s>c) Using two Shelly 2.5&rsquo;s</h4><p>There are also two methods that use two Shelly 2.5&rsquo;s.
Depending on how much room you have to install the Shelly&rsquo;s, you may pick one or the other.<br>The first method is also useful if you don&rsquo;t have Neutral available at the final switch.</p><p>I started with the first method but eventually redid the installation because I had the space and prefered to keep the 2 Shelly&rsquo;s apart to give them some breathing room and keep the temperatures lower.</p><h5 id=both-at-the-end>Both at the end</h5><p>First, you could install both Shelly 2.5&rsquo;s at the final switch.</p><p>Since I have two 2-way switches, I have 4 wires running between both locations (two times two switch wires).<br>Using one set of two wires to carry Live and Neutral, I can power one or both Shelly&rsquo;s.
The other two wires are connected to the two switches and SW1/SW2 of the first Shelly.</p><p>I then powered the 2nd Shelly from the wires present at the final switch (but could&rsquo;ve used the previously repurposed switch wires).<br>The two switches at this side are then connected to SW1/SW2 on the 2nd Shelly, matching the order on the other Shelly.</p><p>I then use the HTTP REST API again to have the first Shelly control the outputs of the 2nd one.</p><p>Note: Instead of matching O1 and O2 of one Shelly with a light each, you could also match each Shelly with a certain light.<br>So you&rsquo;d connect the switches controlling the same light to the same Shelly instead of the same SW#.<br>In this scenario, use O1 for the output and setup an action for SW2 to toggle O1 using <code>localhost</code> as target.</p><p>Note2: You can set a relay to Detached mode if it&rsquo;s not linked to an output, so that it doesn&rsquo;t &ldquo;click&rdquo; when you toggle the connected switch. The call to the API will still be executed.</p><h5 id=each-at-a-switch>Each at a switch</h5><p>I finally chose this setup instead, because it&rsquo;s less cramped and leaves more breathing room for the Shelly&rsquo;s.</p><a href=schematic-2way-sh25.svg title="Wiring double 2-way switch with two Shelly 2.5's" target=_blank><figure class=center><img src=schematic-2way-sh25.svg alt="Wiring double 2-way switch with two Shelly 2.5's"><figcaption class=center>Wiring double 2-way switch with two Shelly 2.5&rsquo;s</figcaption></figure></a><p>This installation is basically the same as when using an i3.</p><a href=schematic-2way-sh25-shi3.svg title="Wiring double 2-way switch with Shelly 2.5 and Shelly i3" target=_blank><figure class=center><img src=schematic-2way-sh25-shi3.svg alt="Wiring double 2-way switch with Shelly 2.5 and Shelly i3"><figcaption class=center>Wiring double 2-way switch with Shelly 2.5 and Shelly i3</figcaption></figure></a><p>If you have Live and Neutral available at both switch locations, you don&rsquo;t even need to repurpose any wires.</p><a href=schematic-2way-sh25-shi3-2.svg title="Wiring double 2-way switch with Shelly 2.5 and Shelly i3 using seperate power feeds" target=_blank><figure class=center><img src=schematic-2way-sh25-shi3-2.svg alt="Wiring double 2-way switch with Shelly 2.5 and Shelly i3 using seperate power feeds"><figcaption class=center>Double 2-way switch with seperate power feeds</figcaption></figure></a><h3 id=three-way-switch-with-shelly1pm>Three-way switch with Shelly1(PM)</h3><p>Below is the most common installation of a 3-way switch, sometimes called 4-way switch or hotel switch.
Three (or more) switches control the same light and physical state of the switch (up/down) is not linked to the state of the lamp.<br>More switches can be added by including more cross-switches in the middle.</p><a href=schematic-3way.svg title="Wiring schematic of 3-way switch" target=_blank><figure class=center><img src=schematic-3way.svg alt="Wiring schematic of 3-way switch"><figcaption class=center>Wiring schematic of 3-way switch</figcaption></figure></a><p>By installing a Shelly1(PM) you can make these switches &ldquo;smart&rdquo;.<br>Install the Shelly as below and set Button Mode to <em>Edge</em>.</p><a href=schematic-3way-shelly.svg title="Wiring schematic of 3-way switch with Shelly1" target=_blank><figure class=center><img src=schematic-3way-shelly.svg alt="Wiring schematic of 3-way switch with Shelly1"><figcaption class=center>Wiring schematic of 3-way switch with Shelly1</figcaption></figure></a><p>Note that you need to either pull an extra wire or <em>borrow</em> one elsewhere to be able to provide permanent Live to the Shelly.</p><h2 id=conclusion>Conclusion</h2><p>The devices by Shelly/Allterco are affordable and flexible.<br>They already have quite a big collection of useful and I&rsquo;m certain many more awesome devices will follow.</p><p>I wrote this article when I installed one Shelly 1PM and two Shelly 2.5&rsquo;s (double 2-way setup).<br>Writing this, I actually realised it might be a good idea to replace one of the 2.5&rsquo;s by a Shelly i3 :P</p><p>By the time I published this article, I already upgraded my installation with 2 more Shelly 1PM (front door and back door lighting), 3 Shelly H&amp;T and 2 Shelly Door/Window 2.<br>I&rsquo;m definitely adding more devices in the future :)</p><p>I also integrated my Shelly&rsquo;s in Home Assistant, together with some other devices in my network, and am using Node-RED to build automations.<br>Since the Shelly firmware 1.8 update had some breaking changes to the CoAP implementation, the <a href=https://github.com/StyraHem/ShellyForHASS title="Shelly for HASS" rel=external target=_blank>ShellyForHASS</a> plugin is currently broken.
So if you want to use this plugin as well (instead of using e.g. MQTT), you&rsquo;ll currently have to stick with or downgrade to the v1.7 until a new update of the plugin is rolled out.<br>The people behind ShellyForHASS are working hard to push a working update out as soon as possible.</p><p>The <a href=https://www.facebook.com/groups/ShellyIoTCommunitySupport/ title="Shelly support group (English Version)" rel=external target=_blank>support group on Facebook</a> is awesome.<br>You have Shelly enthusiasts but also Shelly employees answering just about any question you may have.<br>Also keep an eye on this FB group if you want to stay up-to-date on the latest updates on Shelly, the owner is very active and updates are often posted on FB first.</p><h2 id=changelog>Changelog</h2><h3 id=update-2021-11-06>Update 2021-11-06</h3><ul><li>Add section on Shelly configuration</li></ul><h3 id=update-2021-10-18>Update 2021-10-18</h3><ul><li>Added schematic for 2-way momentary switches</li><li>Small changes in titles</li></ul><h3 id=update-2020-11-06>Update 2020-11-06</h3><ul><li>Added schematic for 3-way switch</li><li>Added schematic for double 2-way switch using 2 different power feeds</li><li>Small modification to installation instructions to clarify usage of different Live wires between switches and Shelly.</li></ul><h3 id=update-2020-11-05>Update 2020-11-05</h3><ul><li>Added schematic for 2-way switch</li></ul><h3 id=update-2020-09-12>Update 2020-09-12</h3><ul><li>ShellyForHASS update is now out of beta and supports Shelly firmware v1.8.x</li></ul><h3 id=update-2020-08-26>Update 2020-08-26</h3><ul><li>Added schematic for wiring two-way switch using buttons and one Shelly 2.5</li><li>Added schematic for wiring two-way switch using Shelly i3 and Shelly 2.5</li></ul></main><hr><footer><div class=footer><p><div class=previous-post><a href="https://sequr.be/blog/2020/06/gitlab-unauthenticated-group-and-project-enumeration/?ref=footer"><span style=font-weight:700>« Previous</span><br>Gitlab unauthenticated group and project...</a><div class=next-post><a href="https://sequr.be/blog/2020/09/upgrade-your-ssh-keys-to-ed25519/?ref=footer"><span style=font-weight:700>Next »</span><br>Upgrade your SSH keys (to Ed25519)</a></div></p></div></footer></article></section><aside class=article-toc><div class=toc-wrapper><h4 id=contents></h4><nav id=TableOfContents><ul><li><a href=#intro>Intro</a></li><li><a href=#requirements>Requirements</a></li><li><a href=#introducing-shelly>Introducing: Shelly</a></li><li><a href=#installation>Installation</a><ul><li><a href=#powering-the-shelly>Powering the Shelly</a></li><li><a href=#shelly-configuration>Shelly configuration</a></li></ul></li><li><a href=#examples>Examples</a><ul><li><a href=#two-way-toggle-switch-with-shelly1pm>Two-way toggle switch with Shelly1(PM)</a></li><li><a href=#two-way-momentary-switch-with-shelly1pm>Two-way momentary switch with Shelly1(PM)</a></li><li><a href=#two-way-switch-renovation>Two-way switch, renovation</a></li><li><a href=#two-way-switch-existing-installation>Two-way switch, existing installation</a><ul><li><a href=#a-using-buttons>a) Using buttons</a></li><li><a href=#b-using-shelly-25-and-shelly-i3>b) Using Shelly 2.5 and Shelly i3</a></li><li><a href=#c-using-two-shelly-25s>c) Using two Shelly 2.5&rsquo;s</a></li></ul></li><li><a href=#three-way-switch-with-shelly1pm>Three-way switch with Shelly1(PM)</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#changelog>Changelog</a><ul><li><a href=#update-2021-11-06>Update 2021-11-06</a></li><li><a href=#update-2021-10-18>Update 2021-10-18</a></li><li><a href=#update-2020-11-06>Update 2020-11-06</a></li><li><a href=#update-2020-11-05>Update 2020-11-05</a></li><li><a href=#update-2020-09-12>Update 2020-09-12</a></li><li><a href=#update-2020-08-26>Update 2020-08-26</a></li></ul></li></ul></nav></div></aside></div></body></html>