<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-US lang=en-US><head><title itemprop=name>MQTT templates for Shelly devices :: Sequr</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=robots content="noodp, noydir"><meta name=googlebot content="noodp, noydir"><meta name=url content="https://sequr.be/blog/2020/10/mqtt-templates-for-shelly-devices/" itemprop=url><link rel=icon href=/favicon.ico><meta itemprop=name content="MQTT templates for Shelly devices"><meta itemprop=description content="Getting started with MQTT, having the correct config is the hardest part. Here I’m sharing my MQTT configs for Shelly devices."><meta itemprop=datePublished content="2020-10-26T00:00:00+01:00"><meta itemprop=dateModified content="2022-01-13T00:00:00+01:00"><meta itemprop=wordCount content="3960"><meta itemprop=image content="https://sequr.be/blog/2020/10/mqtt-templates-for-shelly-devices/cover.svg"><meta itemprop=keywords content="Home Automation,Home Assistant,MQTT,Shelly,Templates,Shellies-Discovery,HACS"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sequr.be/blog/2020/10/mqtt-templates-for-shelly-devices/cover.svg"><meta name=twitter:title content="MQTT templates for Shelly devices"><meta name=twitter:description content="Getting started with MQTT, having the correct config is the hardest part. Here I’m sharing my MQTT configs for Shelly devices."><meta property="og:url" content="https://sequr.be/blog/2020/10/mqtt-templates-for-shelly-devices/"><meta property="og:site_name" content="Sequr"><meta property="og:title" content="MQTT templates for Shelly devices"><meta property="og:description" content="Getting started with MQTT, having the correct config is the hardest part. Here I’m sharing my MQTT configs for Shelly devices."><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2020-10-26T00:00:00+01:00"><meta property="article:modified_time" content="2022-01-13T00:00:00+01:00"><meta property="article:tag" content="Home Automation"><meta property="article:tag" content="Home Assistant"><meta property="article:tag" content="MQTT"><meta property="article:tag" content="Shelly"><meta property="article:tag" content="Templates"><meta property="article:tag" content="Shellies-Discovery"><meta property="og:image" content="https://sequr.be/blog/2020/10/mqtt-templates-for-shelly-devices/cover.svg"><meta name=description content="Getting started with MQTT, having the correct config is the hardest part. Here I&rsquo;m sharing my MQTT configs for Shelly devices."><meta property="og:updated_time" content="2022-01-13T00:00:00+01:00"><link rel=sitemap type=application/xml title=Sitemap href=https://sequr.be/sitemap.xml><meta name=apple-mobile-web-app-title content="MQTT templates for Shelly devices"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><link rel=webmention href=https://webmention.io/sequr.be/webmention><link rel=stylesheet href=/css/bundle.min.5413e5ca00ec5b64f3085a23bc75bd1a5f085d8434d4c0f6bfce3a80dab3fbf8.css integrity="sha256-VBPlygDsW2TzCFojvHW9Gl8IXYQ01MD2v846gNqz+/g=" crossorigin=anonymous><script defer type=text/javascript src=/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js integrity="sha256-FFRTJhp3VfUEKoVMQhNQHSFaj740wI0YHED4A/ExXnQ=" crossorigin=anonymous></script></head><body class=dark-theme><div class=wrapper><aside class="sidebar h-card background-image"><div class="container sidebar-sticky"><div class=light-dark align=right><button class=btn-light-dark title="Toggle light/dark mode"><svg class="moon" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/></svg><svg class="sun" width="1em" height="1em" viewBox="0 0 16 16"><path fill="currentcolor" d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg></button></div><div class="sidebar-about hcard"><h1 class=brand><a href=https://sequr.be/><img src=/logo.png class="u-logo u-photo" alt="Sequr brand image">
</a><a href=https://sequr.be/ class="u-url p-org"><h1>Sequr</h1></a></h1><p class="lead p-note">Writeups and random stuff about infosec and life</p></div><nav><ul class=sidebar-nav><li class=heading><a href=/about/ title=About>About</a></li><li class=heading><a href=/blog/ title=Blog>Blog</a></li><li class=sub-heading>Recent</li><li class=bullet><a href=/blog/2025/01/sending-my-first-webmention-from-scratch/ title="Sending my first webmention from scratch" hreflang=en>My first Webmention</a></li><li class=bullet><a href=/blog/2025/01/bridging-this-blog-with-the-fediverse/ title="Bridging this blog with the Fediverse" hreflang=en>Briding with the Fediverse</a></li><li class=bullet><a href=/blog/2025/01/new-year-new-theme-for-the-site/ title="New year, new theme for the site" hreflang=en>New theme</a></li><li class=heading><a href=/shoppinglist/ title=Shopping>Shopping</a></li><li class=heading><a href=/privacy/ title=Privacy>Privacy</a></li></ul></nav><a target=_blank class=social title="Atom Feed" href=/atom.xml><svg width="1em" height="1.2em" viewBox="0 0 1280 1280"><g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentcolor"><path d="M2295 11929c-284-12-642-45-707-65-17-5-18-63-18-1039 0-569 4-1036 8-1039 5-3 74 6 153 19 510 86 1168 95 1789 25 1348-153 2602-677 3670-1531 385-308 820-744 1126-1129 842-1060 1362-2313 1514-3650 70-621 61-1279-25-1789-13-79-22-148-19-153 3-4 471-8 1039-8h1035l5 23c51 225 85 942 67 1419-23 605-77 1044-198 1617-294 14e2-927 2734-1823 3846-1043 1295-2364 2259-3909 2854-1158 447-2451 656-3707 6e2z"/><path d="M2255 7845c-269-25-620-81-667-106-17-9-18-55-18-899 0-706 3-890 13-890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207-107 2267-823 2814-1902 166-327 268-637 330-1001 38-227 48-384 42-662-8-348-44-590-126-831-23-66-41-126-41-132 0-10 184-13 890-13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782-59 703-233 1323-545 1945-481 956-1313 1788-2270 2268-620 310-1239 483-1940 542-165 14-669 10-840-5z"/><path d="M2519 3815c-391-66-725-336-868-703-79-201-96-462-45-677 83-344 338-641 666-774 116-47 205-69 330-80 412-39 811 153 1040 5e2 193 292 240 648 128 981-135 403-492 699-914 757-1e2 14-241 12-337-4z"/></g></svg></a><a href=https://bsky.app/profile/sequr.be target=_blank class="u-url social" rel="external noopener me" title=Bluesky><svg width="1.2em" height="1.2em" viewBox="0 0 568 501"><path fill="currentcolor" d="M123.121 33.6637C188.241 82.5526 258.281 181.681 284 234.873c25.719-53.192 95.759-152.3204 160.879-201.2093C491.866-1.61183 568-28.9064 568 57.9464 568 75.2916 558.055 203.659 552.222 224.501c-20.275 72.453-94.155 90.933-159.875 79.748C507.222 323.8 536.444 388.56 473.333 453.32c-119.86 122.992-172.272-30.859-185.702-70.281C285.169 375.812 284.017 372.431 284 375.306 283.983 372.431 282.831 375.812 280.369 383.039c-13.43 39.422-65.842 193.273-185.7023 70.281C31.5556 388.56 60.7778 323.8 175.653 304.249 109.933 315.434 36.0535 296.954 15.7778 224.501 9.94525 203.659.0 75.2916.0 57.9464.0-28.9064 76.1345-1.61183 123.121 33.6637z"/></svg></a><a href=https://mastodon-belgium.be/@TerraGloba target=_blank class="u-url social" rel="external noopener me" title=Mastodon>
<svg width="1.2em" height="1.2em" viewBox="0 0 24 24"><path fill="currentcolor" d="M20.94 14c-.28 1.41-2.44 2.96-4.97 3.26-1.31.15-2.6.3-3.97.24-2.25-.11-4-.54-4-.54v.62c.32 2.22 2.22 2.35 4.03 2.42 1.82.05 3.44-.46 3.44-.46l.08 1.65s-1.28.68-3.55.81c-1.25.07-2.81-.03-4.62-.5-3.92-1.05-4.6-5.24-4.7-9.5l-.01-3.43c0-4.34 2.83-5.61 2.83-5.61C6.95 2.3 9.41 2 11.97 2h.06c2.56.0 5.02.3 6.47.96.0.0 2.83 1.27 2.83 5.61.0.0.04 3.21-.39 5.43M18 8.91c0-1.08-.3-1.91-.85-2.56-.56-.63-1.3-.96-2.23-.96-1.06.0-1.87.41-2.42 1.23l-.5.88-.5-.88c-.56-.82-1.36-1.23-2.43-1.23-.92.0-1.66.33-2.23.96C6.29 7 6 7.83 6 8.91v5.26h2.1V9.06c0-1.06.45-1.62 1.36-1.62 1 0 1.5.65 1.5 1.93v2.79h2.07V9.37c0-1.28.5-1.93 1.51-1.93.9.0 1.35.56 1.35 1.62v5.11H18V8.91z"/></svg></a><a href=https://github.com/TheGroundZero target=_blank class="u-url social" rel="external noopener me" title=Github><svg width="1.2em" height="1.2em" viewBox="-2 -2 24 24"><path fill="currentcolor" d="M18.88 1.099C18.147.366 17.265.0 16.233.0H3.746C2.714.0 1.832.366 1.099 1.099.366 1.832.0 2.714.0 3.746v12.487c0 1.032.366 1.914 1.099 2.647.733.733 1.615 1.099 2.647 1.099H6.66c.19.0.333-.007.429-.02a.504.504.0 00.286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555.0 01-.904-.091 2.026 2.026.0 01-.872-.39 1.651 1.651.0 01-.572-.8l-.13-.3a3.25 3.25.0 00-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956.0 01-.17-.156.723.723.0 01-.117-.182c-.026-.061-.004-.111.065-.15.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1.0 01.631.677c.2.355.44.626.722.813.282.186.566.28.852.28.286.0.533-.022.742-.065a2.59 2.59.0 00.585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907.0 01-1.333-.234 5.314 5.314.0 01-1.223-.507 3.5 3.5.0 01-1.047-.872c-.277-.347-.505-.802-.683-1.365-.177-.564-.266-1.215-.266-1.952.0-1.049.342-1.942 1.027-2.68-.32-.788-.29-1.673.091-2.652.252-.079.625-.02 1.119.175.494.195.856.362 1.086.5.23.14.414.257.553.352a9.233 9.233.0 012.497-.338c.859.0 1.691.113 2.498.338l.494-.312a6.997 6.997.0 011.197-.572c.46-.174.81-.221 1.054-.143.39.98.424 1.864.103 2.653.685.737 1.028 1.63 1.028 2.68.0.737-.089 1.39-.267 1.957-.177.568-.407 1.023-.689 1.366a3.65 3.65.0 01-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9.0 01-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36.0 00.208.189c.096.034.18.056.254.064.074.01.18.013.318.013h2.914c1.032.0 1.914-.366 2.647-1.099.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/></svg></a><a href=https://twitter.com/DezeStijn target=_blank class="u-url social" rel="external noopener me" title=Twitter><svg width="1.2em" height="1.2em" viewBox="0 0 16 16"><path fill="currentcolor" d="M5.032 14.286c6.037.0 9.34-4.837 9.34-9.032.0-.137.0-.274-.01-.41A6.56 6.56.0 0016 3.2c-.6.256-1.235.425-1.885.5a3.207 3.207.0 001.443-1.757c-.645.37-1.35.63-2.085.77a3.322 3.322.0 00-1.862-.958 3.384 3.384.0 00-2.082.334 3.223 3.223.0 00-1.442 1.49 3.08 3.08.0 00-.208 2.03 9.57 9.57.0 01-3.747-.963A9.269 9.269.0 011.114 2.292a3.086 3.086.0 00-.36 2.314c.189.787.68 1.475 1.376 1.924A3.344 3.344.0 01.64 6.132v.04c0 .734.263 1.444.743 2.01a3.3 3.3.0 001.89 1.102c-.483.128-.99.146-1.482.055a3.19 3.19.0 001.168 1.577 3.36 3.36.0 001.9.627A6.732 6.732.0 010 12.86a9.527 9.527.0 005.032 1.423"/></svg></a><a href=https://ko-fi.com/s4squatch target=_blank class="u-url social" rel="external noopener" title=Kofi><svg width="1.2em" height="1.2em" viewBox="0 0 24 24"><path fill="currentcolor" d="M23.881 8.948c-.773-4.085-4.859-4.593-4.859-4.593H.723c-.604.0-.679.798-.679.798s-.082 7.324-.022 11.822c.164 2.424 2.586 2.672 2.586 2.672s8.267-.023 11.966-.049c2.438-.426 2.683-2.566 2.658-3.734 4.352.24 7.422-2.831 6.649-6.916zm-11.062 3.511c-1.246 1.453-4.011 3.976-4.011 3.976s-.121.119-.31.023c-.076-.057-.108-.09-.108-.09-.443-.441-3.368-3.049-4.034-3.954-.709-.965-1.041-2.7-.091-3.71.951-1.01 3.005-1.086 4.363.407.0.0 1.565-1.782 3.468-.963 1.904.82 1.832 3.011.723 4.311zm6.173.478c-.928.116-1.682.028-1.682.028V7.284h1.77s1.971.551 1.971 2.638c0 1.913-.985 2.667-2.059 3.015z"/></svg></a><p class=footnote>&copy; 2019
• <a class="p-name u-url" href=https://sequr.be>Sequr</a>
• <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank rel="external noopener">CC BY-NC-SA 4.0</a></p><a href=https://sequr.be/en hreflang=en-US title=English class=u-translation-of rel=alternate><span class="flag fi fi-gb"></span>
</a><a href=https://sequr.be/nl hreflang=nl-BE title=Nederlands class=u-translation-of rel=alternate><span class="flag fi fi-nl"></span></a></div></aside><section class="content container"><article class="post h-entry"><header class=info><h1 class="post-title p-name u-url"><a href=https://sequr.be/blog/2020/10/mqtt-templates-for-shelly-devices/ rel=bookmark>MQTT templates for Shelly devices</a></h1><div class=headline><div><span class="h-card p-author">DezeStijn
</span><span class=whitespace>• </span><time datetime=2020-10-26T00:00:00+0100 class="post-date dt-published">Oct 26, 2020
</time><span class=whitespace></span><time datetime=2022-01-13T00:00:00+0100 class="post-date dt-updated">(Jan 13, 2022)
</time><span class=whitespace>• </span><span class=reading-time><span>19 mins read</span></span></div><ul class=tags><li class="tag-Home Automation"><a class=p-category href=https://sequr.be/categories/home-automation>Home Automation</a></li></ul></div></header><main class=e-content><p>When you&rsquo;re working with MQTT in Home Assistant, you&rsquo;ll know that it does require some manual configuration.<br>Often you&rsquo;re copy/pasting the configs from other devices and adapting them to fit the new devices.</p><p>Below I&rsquo;ve copy/pasted and template-ized the configs I&rsquo;m using.</p><p>If you have an idea for any improvements, hit me up on <a href=https://twitter.com/DezeStijn title="@DezeStijn on Twitter" rel=external target=_blank>Twitter</a>!</p><p>For an introduction on MQTT for Shelly devices, see my blog post: <a href=/blog/2020/10/home-automation-getting-started-with-mqtt-and-home-assistant-and-shelly/ title="Getting started with MQTT and Home Assistant (and Shelly)">Getting started with MQTT and Home Assistant (and Shelly)</a>.</p><h2 id=shellies-discovery>shellies-discovery</h2><p>Some time ago I switched from manually adding Shelly devices via MQTT configurations to an automated script: <a href=https://github.com/bieniu/ha-shellies-discovery title="bieniu/ha-shellies-discovery on GitHub" rel=external target=_blank>ha-shellies-discovery</a>.
It automatically recognizes new Shelly devices talking to the MQTT broker (after the Shelly&rsquo;s been configured to use MQTT) and creates devices and entities for each of them.
So you no longer need to add a new config for each device you added and all entities are nicely grouped per device from the start.</p><p>This script can easily be installed in Home Assistant using <a href=https://hacs.xyz/ title="Home Assistant Community Store - HACS" rel=external target=_blank>HACS</a>.
I won&rsquo;t write a tutorial on doing this, as all required information can be found in the <a href=https://github.com/bieniu/ha-shellies-discovery title="bieniu/ha-shellies-discovery on GitHub" rel=external target=_blank>ha-shellies-discovery</a> documentation.</p><p>Using the configurations examples below to manually add Shelly devices via MQTT is still a valid option.
Espcially if you&rsquo;re wanting to do &rsquo;non-default&rsquo; integrations (e.g. use some templating to modify values).<br>But for regular installs, I&rsquo;d move to the automated option.
We&rsquo;re all using Home Assistant to automate our lives, why not use it to automate device integration?</p><h2 id=shelly-gen-1-and-shelly-gen-2>Shelly Gen 1 and Shelly Gen 2</h2><p>With the introduction of the Shelly 4Pro PM also came the introduction of a new generation of devices.
This new generation also brings in changes in the communication methods, including MQTT.</p><p>The content of this blog posts discusses the Gen 1 devices.
Once the Gen 2 become more readily available, and I get my hands on one or more of them, I may make a new post about the changes.</p><h2 id=configuration-file-structure>Configuration file structure</h2><p>First of all, an important factor in keeping everyting readable and manageable, working with the directory structure is a must!</p><p>The king of <em>configuration splitting</em> (as it&rsquo;s called) is Frenck.<br>Check out <a href="https://www.youtube.com/watch?v=FfjSA2o_0KA" title="Understanding YAML as it's used in Home Assistant Config files" rel=external target=_blank>these</a> <a href="https://www.youtube.com/watch?v=Wge9FDHoZDs" title="Finally Organizing my Home Assistant Config w/ Franck" rel=external target=_blank>videos</a> of him and DrZzs and <a href=https://gist.github.com/frenck/20a3236cf64bf5bbcb907ecc7cf665cd title="Frenck's notes on Home Assistant" rel=external target=_blank>Frenck&rsquo;s notes</a> to learn more about the different options.</p><p>I generally group configurations for devices by their type/use (e.g. lights).<br>This does mean that some configs that are more related to the device (e.g. device temp) are grouped with that light.</p><p>My current configuration filetree looks as follows.<br>Note that I skipped files/folders not relevant to this post.</p><pre tabindex=0><code>.
+-- automations.yaml
+-- configuration.yaml
+-- groups.yaml
+-- scripts.yaml
+-- binsensors
|   +-- room_x
|   |   +-- lamps.yaml
|   +-- etc.
+-- customisations
|   +-- customize_domain.yaml
|   +-- customize_glob.yaml
|   +-- customize.yaml
+-- lights
|   +-- room_x
|   |   +-- lamps.yaml
|   +-- etc.
+-- sensors
|   +-- room_x
|   |   +-- lamps.yaml
|   |   +-- shelly_ht.yaml
|   +-- room_y
|   |   +-- lamps.yaml
|   |   +-- shelly_dw2.yaml
|   +-- etc.
+-- switches
|   +-- room_x
|   |   +-- floorlamp.yaml
</code></pre><p>To get this to work, I added the following lines to <code>configuration.yaml</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>homeassistant</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>customize_domain</span>: !<span style=color:#ae81ff>include customisations/customize_domain.yaml</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>customize_glob</span>: !<span style=color:#ae81ff>include customisations/customize_glob.yaml</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>customize</span>: !<span style=color:#ae81ff>include customisations/customize.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>automation</span>: !<span style=color:#ae81ff>include automations.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>group</span>: !<span style=color:#ae81ff>include group.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>script</span>: !<span style=color:#ae81ff>include scripts.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>binary_sensor</span>: !<span style=color:#ae81ff>include_dir_merge_list binsensors/</span>
</span></span><span style=display:flex><span><span style=color:#f92672>light</span>: <span style=color:#ae81ff>include_dir_merge_list lights/</span>
</span></span><span style=display:flex><span><span style=color:#f92672>sensor</span>: <span style=color:#ae81ff>include_dir_merge_list sensors/</span>
</span></span><span style=display:flex><span><span style=color:#f92672>switch</span>: <span style=color:#ae81ff>include_dir_merge_list switchess/</span>
</span></span></code></pre></div><h2 id=mqtt-templates>MQTT Templates</h2><p>Note that I&rsquo;m only sharing the configs of devices I already own.<br>If you want me to check out another device, I can either try to make up the configs based on the <a href=https://shelly-api-docs.shelly.cloud/#mqtt-support title="Shelly docs - MQTT support" rel=external target=_blank>Docs</a> or you can send me one and I&rsquo;ll have a go at it (hit me up on <a href=https://twitter.com/DezeStijn title="@DezeStijn on Twitter" rel=external target=_blank>Twitter</a>).</p><h3 id=platform-light-switch-cover->Platform: light, switch, cover, &mldr;</h3><p>While the Shelly devices like 1/1L/1PM/2.5/Plug/Plug_S are in fact &ldquo;just&rdquo; relays, the installation posibilities are endless.<br>Most commonly, they&rsquo;re used to control lights or wall sockets.</p><p>In Home Assistant, devices can be configured as a <code>switch</code>, which gives you simple on/off capabilities.<br>But you can also configure a device as <code>light</code>, which will also give you control over brightness and colour temp, if the device supports it.<br>Configuring a device as <code>cover</code> allows you to control things like blinds, curtains, shades, shutters, garage doors, &mldr;</p><p>All of my Shelly devices are currently configured as lights.<br>However, it&rsquo;s just a matter of setting the correct platform and/or adding the config in the right file for your Shelly to be configured as switch, cover, &mldr;</p><h2 id=shelly-relays-1-1pm-1l-25>Shelly relays (1, 1PM, 1L, 2.5)</h2><p>The Shelly relays allow you to toggle one or more channels on/off, give you the switch state and may give you info on power consumption and device temperature.</p><p>Some devices, like the Shelly2.5 have multiple switch inputs and outputs. These need to be added individually.</p><h3 id=light-vs-switch-setup>Light vs Switch setup</h3><p>The examples below assume the Shelly relay was connected to a lamp.
However, you can use the relay to toggle a wall socket, heater, swimming pool pump, garden watering system, &mldr;</p><p>Since a Shelly relay (e.g. Shelly 1 or 2.5) only supports on/off toggling, so it doesn&rsquo;t <em>really</em> matter whether it&rsquo;s configured as a light or a switch.</p><p>If you want Home Assistant to recognise the Shelly purely as an on-off switch, move the config below to <code>switches/room_x/fan.yaml</code> (for example).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /lights/room_x/lamps.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Lamp room X - Shelly 1PM</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#e6db74>&#34;on&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#e6db74>&#34;off&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/relay/0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/relay/0/command</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>json_attributes_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/info</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## /lights/room_y/lamps.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Lamp room Ya - Shelly 2.5</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room Y - lamp A</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#e6db74>&#34;on&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#e6db74>&#34;off&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-[SHELLY ID]/relay/0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-[SHELLY ID]/relay/0/command</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>json_attributes_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-[SHELLY ID]/info</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Lamp room Yb - Shelly 2.5</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room Y - lamp B</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#e6db74>&#34;on&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#e6db74>&#34;off&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-[SHELLY ID]/relay/1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-[SHELLY ID]/relay/1/command</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>json_attributes_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-[SHELLY ID]/info</span>
</span></span></code></pre></div><h3 id=binary-sensors>Binary sensors</h3><p>These binary sensors allow you to create automations for a long-push on the connected button, but also give you some insights on the device state.</p><p>Again, repeat add extra relays if needed by copying the relevant sections and changing the relay number.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># /binsensors/room_x/lamps.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Longpush</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - longpush</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/longpush/0</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Switch state</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - switch</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/input/0</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Over temp</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - overtemp</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/overtemperature</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Firmware upgrade</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - firmware</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/announce</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value_json.new_fw }}&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#66d9ef>false</span>
</span></span></code></pre></div><h3 id=sensors>Sensors</h3><p>The <code>input_event</code> sensor again allows you to build automations based on the actions of the connected switch.
The remaining sensors give you insights on the device status.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /sensors/room_x/lamp.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Input type</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - input</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/input_event/0</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Device temperature °C</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - temperature</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>temperature</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;°C&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:temperature-celcius</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/temperature</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Device temperature °F</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - temperature F</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>temperature</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;°F&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:temperature-fahrenheit</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/temperature_f</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Power consumption (live)</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - power</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>power</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;W&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:lightning-bolt-outline</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/relay/0/power</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Power consumption (since reboot)</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - energy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>energy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_class</span>: <span style=color:#ae81ff>total_increasing</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;Wh&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value | float / 60 }}&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:lightning-bolt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/relay/0/energy</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Overpower</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - overpower</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>power</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;W&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:flash-alert</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/overpower_value</span>
</span></span></code></pre></div><h3 id=external-sensors>External sensors</h3><p>If you have external temperature or humidity sensors connected to the Shelly 1PM, you can also read their values over MQTT.</p><h4 id=temperature>Temperature</h4><p>Up to 3 DS1820 sensors can be added to the Shelly 1PM.<br>You can read their values from the sensor IDs 0, 1, 2.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /sensors/room_x/lamp.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Temp sensor 0 °C</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - temperature 0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>temperature</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;°C&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:home-thermometer-outline</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/ext_temperature/0</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Temp sensor 0 °F</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - temperature 0 F</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>temperature</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;°F&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:home-thermometer-outline</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/ext_temperature_f/0</span>
</span></span></code></pre></div><h4 id=humidity>Humidity</h4><p>If a DHT22 sensor is added, it&rsquo;ll also report on humdity.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /sensors/room_x/lamp.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Humidity sensor 0 %</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - humidity 0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>humidity</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;%&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:water-percent</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/ext_humidity/0</span>
</span></span></code></pre></div><h4 id=combined-sensor-output>Combined sensor output</h4><p>Returns the output of the attached sensors along with their hardware ID in one JSON payload.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /sensors/room_x/lamp.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># External tmp sensors °C</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - temperatures</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>temperature</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;°C&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:home-thermometer-outline</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/ext_temperatures</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>json_attributes_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/ext_temperatures</span>
</span></span><span style=display:flex><span><span style=color:#75715e># External tmp sensors °F</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - temperatures F</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>temperature</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;°F&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:home-thermometer-outline</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/ext_temperatures_f</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>json_attributes_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/ext_temperatures_f</span>
</span></span><span style=display:flex><span><span style=color:#75715e># External humidity sensors</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - lamp - humidities</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>humidity</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;%&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:water-percent</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/ext_humidities</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>json_attributes_topic</span>: <span style=color:#ae81ff>shellies/shelly1pm-[SHELLY ID]/ext_humidities</span>
</span></span></code></pre></div><h2 id=shelly-25>Shelly 2.5</h2><p>The Shelly 2.5 has 2 switch inputs and 2 relays.
These relays can be used to control 2 different loads (e.g. 2 lamps in a room) or to control the up/down motion of rolling shutters.<br>Make sure to set the device in the correct mode!</p><h3 id=relay-mode>Relay Mode</h3><p>The Shelly 2.5 works similar as the 1PM while in Relay Mode.<br>Just note that the 2.5 has 2 switch inputs and 2 relay outputs, so you&rsquo;d need to duplicate configs specific to those, one linked to input/relay <code>0</code> and to other to input/relay <code>1</code>.</p><p>Controlling the 2 relays:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /switches/room_abc/shelly_25.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Shelly 2.5 - relay 1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#e6db74>&#34;on&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#e6db74>&#34;off&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/relay/0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/relay/0/command</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Shelly 2.5 - relay 2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#e6db74>&#34;on&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#e6db74>&#34;off&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/relay/1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/relay/1/command</span>
</span></span></code></pre></div><p>Read inputs on the 2 switch inputs:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /sensors/room_abc/shelly_25.yaml</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Shelly 2.5 - input 1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/input_event/0</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Shelly 2.5 - input 2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/input_event/1</span>
</span></span></code></pre></div><p>Longpush detection on the 2 switch inputs:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /binsensors/room_abc/shelly_25.yaml</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Shelly 2.5 - longpush 1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/longpush/0</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Shelly 2.5 - longpush 2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/longpush/1</span>
</span></span></code></pre></div><h3 id=roller-mode>Roller Mode</h3><p>Home Assistant has the <code>cover</code> integration, which we can use to integrate our Shelly 2.5 in Roller Mode.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>cover</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Rolling Shutters</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>command_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/roller/0/command</span> <span style=color:#75715e># rc, open, close and stop</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/roller/0</span> <span style=color:#75715e># open, close, stop</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>position_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/roller/0/pos</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>set_position_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/roller/0/command/pos</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>availability_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/online</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>json_attributes_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/info</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>payload_open</span>: <span style=color:#ae81ff>open</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>payload_close</span>: <span style=color:#ae81ff>close</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>payload_stop</span>: <span style=color:#ae81ff>stop</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>state_opening</span>: <span style=color:#ae81ff>open</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>state_closing</span>: <span style=color:#ae81ff>close</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>position_open</span>: <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>position_closed</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>payload_available</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>payload_not_available</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>switch</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Rolling Shutters - Calibrate</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>command_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/roller/0/command</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>rc</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Rolling Shutters - FW upgrade</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>command_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/command</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>update_fw</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>binary_sensor</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Rolling Shutters - switch open</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>payload_off</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/input/0</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Rolling Shutters - switch close</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>payload_off</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/input/1</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Rolling Shutters - overtemperature</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>payload_off</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/overtemperature</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Rolling Shutters - firmware available</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>payload_on</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>payload_off</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value_json.new_fw }}&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/announce</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>sensor</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Rolling Shutters - temperature</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>temperature</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;°C&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/temperature</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Rolling Shutters - power consumption</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>power</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;W&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/roller/0/power</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Rolling Shutters - energy consumption since last reboot</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>energy</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>state_class</span>: <span style=color:#ae81ff>total_increasing</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;Wh&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value | float / 60 }}&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyswitch25-&lt;deviceid&gt;/roller/0/energy</span>
</span></span></code></pre></div><h2 id=shelly-i3>Shelly i3</h2><h3 id=sensors-1>Sensors</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /sensors/room_z/switch.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Shelly i3 - Input 1</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Room Z - switch - input 1&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyix3-[SHELLY ID]/input_event/0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Shelly i3 - Input 2</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Room Z - switch - input 2&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyix3-[SHELLY ID]/input_event/1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Shelly i3 - Input 3</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Room Z - switch - input 3&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyix3-[SHELLY ID]/input_event/2&#34;</span>
</span></span></code></pre></div><h3 id=binary-sensors-1>Binary Sensors</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /binsensors/room_z/switch.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Online</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Room Z - switch&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyix3-[SHELLY ID]/online&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>json_attributes_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyix3-[SHELLY ID]/info&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Switch 1</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Room Z - switch - switch 1&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyix3-[SHELLY ID]/input/0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Switch 2</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Room Z - switch - switch 2&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyix3-[SHELLY ID]/input/1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Switch 3</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Room Z - switch - switch 3&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyix3-[SHELLY ID]/input/2&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Firmware upgrade</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Room Z - switch - firmware&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyix3-[SHELLY ID]/announce&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value_json.new_fw }}&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#66d9ef>false</span>
</span></span></code></pre></div><h2 id=shelly-plug-s>Shelly Plug (S)</h2><p>The Shelly Plug S added a temperature sensor and overtemperature warning, which the Shelly Plug doesn&rsquo;t.</p><p>Also note the small difference in the model naming when entering the MQTT topic for the Shelly Plug and Shelly Plugs S (<code>shellyplug</code> / <code>shellyplug-s</code>).</p><h3 id=light-vs-switch-setup-1>Light vs Switch setup</h3><p>Again, the template below is for configuring the entity to show up as a lamp in HA.
E.g. when a floorlamp is connected to the Shelly Plug (S).</p><p>If the Plug (S) controls something different, like a fan, you may want to add the config below to a file in the <code>switches</code> folder.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /lights/room_x/floorlamp.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - floorlamp</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#e6db74>&#34;on&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#e6db74>&#34;off&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyplug-s-[SHELLY ID]/relay/0&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyplug-s-[SHELLY ID]/relay/0/command&#34;</span>
</span></span></code></pre></div><h3 id=binary-sensors-2>Binary Sensors</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /binsensors/room_x/floorlamp.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Online</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Room X - floorlamp&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyplug-s-[SHELLY ID]/online&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>json_attributes_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyplug-s-[SHELLY ID]/info&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Switch</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Room X - floorlamp - switch&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#e6db74>&#34;on&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#e6db74>&#34;off&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyplug-s-[SHELLY ID]/relay/0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Overtemp (Shelly Plug S only)</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Room X - floorlamp - overtemperature&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyplug-s-[SHELLY ID]/overtemperature&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h3 id=sensors-2>Sensors</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /sensors/room_x/floorlamp.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Power consumption</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - floorlamp - power</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>power</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;W&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:lightning-bolt-outline</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyplug-s-[SHELLY ID]/relay/0/power</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Energy consumption</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - floorlamp - energy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>energy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_class</span>: <span style=color:#ae81ff>total_increasing</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;Wh&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value | float / 60 }}&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:lightning-bolt-outline</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyplug-s-[SHELLY ID]/relay/0/energy</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Overpower value</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - floorlamp - overpower</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>power</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;W&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:flash-alert-outline</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyplug-s-[SHELLY ID]/overpower_value</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Temperature °C (Shelly Plug S only)</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - floorlamp - temperature</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>temperature</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;°C&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:temperature-celsius</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyplug-s-[SHELLY ID]/temperature</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Temperature °F (Shelly Plug S only)</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Room X - floorlamp - temperature</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>temperature</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;°F&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:temperature-fahrenheit</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#ae81ff>shellies/shellyplug-s-[SHELLY ID]/temperature_f</span>
</span></span></code></pre></div><h2 id=shelly-dw2>Shelly DW2</h2><p>Shelly&rsquo;s Door/Window sensor.</p><h3 id=sensors-3>Sensors</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /sensors/doors/frontdoor.yaml</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Front door - lux&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;lm&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>illuminance</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>#icon: mdi:theme-light-dark</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellydw2-[SHELLY ID]/sensor/lux&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Front door - tilt&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;°&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:format-rotate-90</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellydw2-[SHELLY ID]/sensor/tilt&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Front door - batterij&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;%&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>battery</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>#icon: mdi:battery</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellydw2-[SHELLY ID]/sensor/battery&#34;</span>
</span></span></code></pre></div><h3 id=binary-sensors-3>Binary Sensors</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /binsensors/doors/frontdoor.yaml</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Front door - Status&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>door</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#e6db74>&#34;open&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#e6db74>&#34;close&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellydw2-[SHELLY ID]/sensor/state&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Front door - Vibration&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>vibration</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellydw2-[SHELLY ID]/sensor/vibration&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Front door - Firmware&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellydw2-[SHELLY ID]/announce&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value_json.new_fw }}&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#66d9ef>false</span>
</span></span></code></pre></div><h2 id=shelly-em>Shelly EM</h2><p>Shelly Energy Meter</p><h3 id=sensors-4>Sensors</h3><p>The EM has 2 probes.
The config below is for the 1st probe.
Copy the all parts in the config for <em>Phase A</em> and replace <code>emeter/0</code> with <code>emeter/1</code> for <em>Phase B</em>.</p><p>The &lsquo;current&rsquo; counters reset on device reboot.<br>The &rsquo;total&rsquo; counters are stored in the non-volatile memory.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /sensors/energy/shelly_em.yaml</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;EM - Phase A - Energy&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value|float / 60000 }}&#34;</span> <span style=color:#75715e># Wm to kWh</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;kWh&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>energy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_class</span>: <span style=color:#ae81ff>total_increasing</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem-&lt;deviceid&gt;/emeter/0/energy&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;EM - Phase A - Returned Energy&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value|float / 60000 }}&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;kWh&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>energy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_class</span>: <span style=color:#ae81ff>total_increasing</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem-&lt;deviceid&gt;/emeter/0/returned_energy&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;EM - Phase A - Total Energy&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value|float / 60000 }}&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;kWh&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>energy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_class</span>: <span style=color:#ae81ff>total_increasing</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem-&lt;deviceid&gt;/emeter/0/total_energy&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;EM - Phase A - Total Returned Energy&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value|float / 60000 }}&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;kWh&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>energy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_class</span>: <span style=color:#ae81ff>total_increasing</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem-&lt;deviceid&gt;/emeter/0/total_returned&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;EM - Phase A - Power&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;W&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>power</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem-&lt;deviceid&gt;/emeter/0/power&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;EM - Phase A - Reactive Power&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;W&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>power</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem-&lt;deviceid&gt;/emeter/0/reactive_power&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;EM - Phase A - Voltage&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;V&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>voltage</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem-&lt;deviceid&gt;/emeter/0/voltage&#34;</span>
</span></span></code></pre></div><h3 id=binary-sensors-4>Binary Sensors</h3><p>Note: this part is untested.<br>If this doesn&rsquo;t work, and you know how to fix it, reach out to me on <a href=https://twitter.com/DezeStijn title="@DezeStijn on Twitter" rel=external target=_blank>Twitter</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /binsensors/energy/shelly_em.yaml</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;EM - Relay Overpower&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem-&lt;deviceid&gt;/relay/0&#34;</span> <span style=color:#75715e># on, off, or overpower</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: {{ <span style=color:#e6db74>&#39;on&#39;</span> <span style=color:#ae81ff>if value == &#39;overpower&#39; else &#39;off&#39; }}</span>
</span></span></code></pre></div><h3 id=switches>Switches</h3><p>Note: the value template part is untested.<br>If this doesn&rsquo;t work, and you know how to fix it, reach out to me on <a href=https://twitter.com/DezeStijn title="@DezeStijn on Twitter" rel=external target=_blank>Twitter</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /switches/energy/shelly_em.yaml</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;EM - Relay&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem-&lt;deviceid&gt;/relay/0/command&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem-&lt;deviceid&gt;/relay/0&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: {{ <span style=color:#e6db74>&#39;on&#39;</span> <span style=color:#ae81ff>if value == &#39;on&#39; else &#39;off&#39; }}</span> <span style=color:#75715e># Test for capturing &#39;overpower&#39; state</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;EM - Phase A - Reset Totals&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>optimistic</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#e6db74>&#34;reset_totals&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem-&lt;deviceid&gt;/emeter/0/command&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;EM - Reset Device Data&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>optimistic</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#e6db74>&#34;reset_data&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem-&lt;deviceid&gt;/command&#34;</span>
</span></span></code></pre></div><h2 id=shelly-3em>Shelly 3EM</h2><p>Shelly 3-phase Energy Meter</p><h3 id=sensors-5>Sensors</h3><p>The 3EM has 3 probes.
The config below is for the 1st probe.
Copy the all parts in the config for <em>Phase A</em> and replace <code>emeter/0</code> with <code>emeter/1</code> or <code>emeter/2</code> for <em>Phase B</em> and <em>Phase C</em> respectively.</p><p>The &lsquo;current&rsquo; counters reset on device reboot.<br>The &rsquo;total&rsquo; counters are stored in the non-volatile memory.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /sensors/energy/shelly_3em.yaml</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;3EM - Phase A - Energy&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value|float / 60000 }}&#34;</span> <span style=color:#75715e># Wm to kWh</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;kWh&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>energy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_class</span>: <span style=color:#ae81ff>total_increasing</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem3-&lt;deviceid&gt;/emeter/0/energy&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;3EM - Phase A - Returned Energy&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value|float / 60000 }}&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;kWh&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>energy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_class</span>: <span style=color:#ae81ff>total_increasing</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem3-&lt;deviceid&gt;/emeter/0/returned_energy&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;3EM - Phase A - Total Energy&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value|float / 60000 }}&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;kWh&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>energy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_class</span>: <span style=color:#ae81ff>total_increasing</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem3-&lt;deviceid&gt;/emeter/0/total_energy&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;3EM - Phase A - Total Returned Energy&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value|float / 60000 }}&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;kWh&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>energy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_class</span>: <span style=color:#ae81ff>total_increasing</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem3-&lt;deviceid&gt;/emeter/0/total_returned&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;3EM - Phase A - Power&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;W&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>power</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem3-&lt;deviceid&gt;/emeter/0/power&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;3EM - Phase A - Voltage&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;V&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>voltage</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem3-&lt;deviceid&gt;/emeter/0/voltage&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;3EM - Phase A - Current&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;A&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>current</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem3-&lt;deviceid&gt;/emeter/0/current&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;3EM - Phase A - Power Factor&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># If the PF is returned as a value between 0.0 and 1.0</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># instead of a % value between 0 and 100</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># uncomment the line below</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>#value_template: &#34;{{ value|float * 100 }}&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;%&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>power_factor</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem3-&lt;deviceid&gt;/emeter/0/pf&#34;</span>
</span></span></code></pre></div><h3 id=binary-sensors-5>Binary Sensors</h3><p>Note: this part is untested.<br>If this doesn&rsquo;t work, and you know how to fix it, reach out to me on <a href=https://twitter.com/DezeStijn title="@DezeStijn on Twitter" rel=external target=_blank>Twitter</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /binsensors/energy/shelly_3em.yaml</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;3EM - Relay Overpower&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem3-&lt;deviceid&gt;/relay/0&#34;</span> <span style=color:#75715e># on, off, or overpower</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: {{ <span style=color:#e6db74>&#39;on&#39;</span> <span style=color:#ae81ff>if value == &#39;overpower&#39; else &#39;off&#39; }}</span>
</span></span></code></pre></div><h3 id=switches-1>Switches</h3><p>Note: the value template part is untested.<br>If this doesn&rsquo;t work, and you know how to fix it, reach out to me on <a href=https://twitter.com/DezeStijn title="@DezeStijn on Twitter" rel=external target=_blank>Twitter</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /switches/energy/shelly_3em.yaml</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;3EM - Relay&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem3-&lt;deviceid&gt;/relay/0/command&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem3-&lt;deviceid&gt;/relay/0&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Remove the line below if the value_template doesn&#39;t function properly</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: {{ <span style=color:#e6db74>&#39;on&#39;</span> <span style=color:#ae81ff>if value == &#39;on&#39; else &#39;off&#39; }}</span> <span style=color:#75715e># Test for capturing &#39;overpower&#39; state</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;3EM - Phase A - Reset Totals&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>optimistic</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#e6db74>&#34;reset_totals&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem3-&lt;deviceid&gt;/emeter/0/command&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;3EM - Reset Device Data&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>optimistic</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#e6db74>&#34;reset_data&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command_topic</span>: <span style=color:#e6db74>&#34;shellies/shellyem3-&lt;deviceid&gt;/command&#34;</span>
</span></span></code></pre></div><h2 id=shelly-4pro>Shelly 4Pro</h2><p>Shelly 4-channel DIN mountable relay</p><h3 id=sensors-6>Sensors</h3><p>The 4Pro has 4 channels.
The config below is for the 1st channel.
Copy the all parts in the config for <em>Channel 1</em>
and replace <code>input/0</code> and <code>relay/0</code> with <code>input/1</code> and <code>relay/1</code>, up to <code>input/3</code> and <code>relay/3</code> for channels 2 to 4 respectively.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /sensors/din/shelly_4pro.yaml</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;4Pro - Channel 1 - Power&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;W&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>power</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shelly4pro-&lt;deviceid&gt;/relay/0/power&#34;</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;4Pro - Channel 1 - Energy&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: <span style=color:#e6db74>&#34;{{ value|float / 60000 }}&#34;</span> <span style=color:#75715e># Wm to kWh</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>unit_of_measurement</span>: <span style=color:#e6db74>&#39;kWh&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>device_class</span>: <span style=color:#ae81ff>energy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_class</span>: <span style=color:#ae81ff>total_increasing</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shelly4pro-&lt;deviceid&gt;/relay/0/energy&#34;</span>
</span></span></code></pre></div><h3 id=binary-sensors-6>Binary Sensors</h3><p>Note: this part is untested.<br>If this doesn&rsquo;t work, and you know how to fix it, reach out to me on <a href=https://twitter.com/DezeStijn title="@DezeStijn on Twitter" rel=external target=_blank>Twitter</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /binsensors/din/shelly_4pro.yaml</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;4Pro - Channel 1 Overpower&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shelly4pro-&lt;deviceid&gt;/relay/0&#34;</span> <span style=color:#75715e># on, off, or overpower</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: {{ <span style=color:#e6db74>&#39;on&#39;</span> <span style=color:#ae81ff>if value == &#39;overpower&#39; else &#39;off&#39; }}</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;4Pro - Channel 1 Input&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>86400</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shelly4pro-&lt;deviceid&gt;/input/0&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h3 id=switches-2>Switches</h3><p>Note: the value template part is untested.<br>If this doesn&rsquo;t work, and you know how to fix it, reach out to me on <a href=https://twitter.com/DezeStijn title="@DezeStijn on Twitter" rel=external target=_blank>Twitter</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /switches/din/shelly_4pro.yaml</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>platform</span>: <span style=color:#ae81ff>mqtt</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;4Pro - Channel 1&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>expire_after</span>: <span style=color:#ae81ff>604800</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>qos</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>command_topic</span>: <span style=color:#e6db74>&#34;shellies/shelly4pro-&lt;deviceid&gt;/relay/0/command&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_on</span>: <span style=color:#e6db74>&#34;on&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>payload_off</span>: <span style=color:#e6db74>&#34;off&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>state_topic</span>: <span style=color:#e6db74>&#34;shellies/shelly4pro-&lt;deviceid&gt;/relay/0&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Remove the line below if the value_template doesn&#39;t function properly</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value_template</span>: {{ <span style=color:#e6db74>&#39;on&#39;</span> <span style=color:#ae81ff>if value == &#39;on&#39; else &#39;off&#39; }}</span> <span style=color:#75715e># Test for capturing &#39;overpower&#39; state</span>
</span></span></code></pre></div><h2 id=groups>Groups</h2><p>I like grouping all entities together for a quick overview</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>## /groups.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Room X</span>
</span></span><span style=display:flex><span><span style=color:#75715e>## Shelly 1PM</span>
</span></span><span style=display:flex><span><span style=color:#f92672>shelly_room_x_lamp</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Shelly Room X lamp</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>entities</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>light.room_x_lamp</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>sensor.room_x_lamp_input</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>sensor.room_x_lamp_temperature</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>sensor.room_x_lamp_temperature_f</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>sensor.room_x_lamp_power</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>sensor.room_x_lamp_energy</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>sensor.room_x_lamp_overpower</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>binary_sensor.room_x_lamp_longpush</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>binary_sensor.room_x_lamp_switch</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>binary_sensor.room_x_lamp_overtemp</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>binary_sensor.room_x_lamp_firmware</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># External sensors</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>sensor.room_x_lamp_temperature_0</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>sensor.room_x_lamp_temperature_0_f</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>sensor.room_x_lamp_humidity_0</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>sensor.room_x_lamp_temperatures</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>sensor.room_x_lamp_temperatures_f</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>sensor.room_x_lamp_humidities</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Room Z</span>
</span></span><span style=display:flex><span><span style=color:#75715e>## Shelly i3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>shelly_room_z_switch</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Shelly Room Z i3</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>entities</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>sensor.room_z_switch_input_1</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>sensor.room_z_switch_input_2</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>sensor.room_z_switch_input_3</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>binary_sensor.room_z_switch</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>binary_sensor.room_z_switch_switch_1</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>binary_sensor.room_z_switch_switch_2</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>binary_sensor.room_z_switch_switch_3</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>binary_sensor.room_z_switch_firmware</span>
</span></span></code></pre></div><h2 id=customisations>Customisations</h2><h3 id=icons>Icons</h3><p>Setting icons for platforms that don&rsquo;t support it out-of-the-box</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># /customisations/customize_glob.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Longpush</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;binary_sensor.*_longpush&#34;</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:gesture-tap-hold</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Switch state</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;binary_sensor.*_switch&#34;</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:light-switch</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Over temperature</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;binary_sensor.*_overtemperature&#34;</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:thermometer-alert</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Firmware upgrade</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;binary_sensor.*_firmware&#34;</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:upload</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># /customisations/customize.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Lights</span>
</span></span><span style=display:flex><span><span style=color:#f92672>light.all_lights</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>icon</span>: <span style=color:#ae81ff>mdi:lightbulb-group</span>
</span></span></code></pre></div><h2 id=changelog>Changelog</h2><p><strong>2021-08-30</strong></p><ul><li>Note on Shelly Gen 2 devices</li></ul><p><strong>2021-04-26</strong></p><ul><li>Added reference to <a href=https://github.com/bieniu/ha-shellies-discovery title="bieniu/ha-shellies-discovery on GitHub" rel=external target=_blank>ha-shellies-discovery</a></li></ul><p><strong>2021-03-21</strong></p><ul><li>Added template for Shelly EM</li><li>Added template for Shelly 3EM</li><li>Added template for Shelly 4Pro</li></ul><p><strong>2020-11-09</strong></p><ul><li>Added template for Shelly i3</li><li>Added template for Shelly Plug S</li></ul></main><hr><footer><div class=footer><p><div class=previous-post><a href="https://sequr.be/blog/2020/10/getting-started-with-mqtt-and-home-assistant-and-shelly/?ref=footer"><span style=font-weight:700>« Previous</span><br>Getting started with MQTT and Home Assistant (and...</a><div class=next-post><a href="https://sequr.be/blog/2020/11/adding-xiaomi-aqara-door-and-window-sensor-to-ha-via-deconz-conbee-ii/?ref=footer"><span style=font-weight:700>Next »</span><br>Adding Xiaomi Aqara Door and Window Sensor to HA...</a></div></p></div></footer></article></section><aside class=article-toc><div class=toc-wrapper><h4 id=contents></h4><nav id=TableOfContents><ul><li><a href=#shellies-discovery>shellies-discovery</a></li><li><a href=#shelly-gen-1-and-shelly-gen-2>Shelly Gen 1 and Shelly Gen 2</a></li><li><a href=#configuration-file-structure>Configuration file structure</a></li><li><a href=#mqtt-templates>MQTT Templates</a><ul><li><a href=#platform-light-switch-cover->Platform: light, switch, cover, &mldr;</a></li></ul></li><li><a href=#shelly-relays-1-1pm-1l-25>Shelly relays (1, 1PM, 1L, 2.5)</a><ul><li><a href=#light-vs-switch-setup>Light vs Switch setup</a></li><li><a href=#binary-sensors>Binary sensors</a></li><li><a href=#sensors>Sensors</a></li><li><a href=#external-sensors>External sensors</a><ul><li><a href=#temperature>Temperature</a></li><li><a href=#humidity>Humidity</a></li><li><a href=#combined-sensor-output>Combined sensor output</a></li></ul></li></ul></li><li><a href=#shelly-25>Shelly 2.5</a><ul><li><a href=#relay-mode>Relay Mode</a></li><li><a href=#roller-mode>Roller Mode</a></li></ul></li><li><a href=#shelly-i3>Shelly i3</a><ul><li><a href=#sensors-1>Sensors</a></li><li><a href=#binary-sensors-1>Binary Sensors</a></li></ul></li><li><a href=#shelly-plug-s>Shelly Plug (S)</a><ul><li><a href=#light-vs-switch-setup-1>Light vs Switch setup</a></li><li><a href=#binary-sensors-2>Binary Sensors</a></li><li><a href=#sensors-2>Sensors</a></li></ul></li><li><a href=#shelly-dw2>Shelly DW2</a><ul><li><a href=#sensors-3>Sensors</a></li><li><a href=#binary-sensors-3>Binary Sensors</a></li></ul></li><li><a href=#shelly-em>Shelly EM</a><ul><li><a href=#sensors-4>Sensors</a></li><li><a href=#binary-sensors-4>Binary Sensors</a></li><li><a href=#switches>Switches</a></li></ul></li><li><a href=#shelly-3em>Shelly 3EM</a><ul><li><a href=#sensors-5>Sensors</a></li><li><a href=#binary-sensors-5>Binary Sensors</a></li><li><a href=#switches-1>Switches</a></li></ul></li><li><a href=#shelly-4pro>Shelly 4Pro</a><ul><li><a href=#sensors-6>Sensors</a></li><li><a href=#binary-sensors-6>Binary Sensors</a></li><li><a href=#switches-2>Switches</a></li></ul></li><li><a href=#groups>Groups</a></li><li><a href=#customisations>Customisations</a><ul><li><a href=#icons>Icons</a></li></ul></li><li><a href=#changelog>Changelog</a></li></ul></nav></div></aside></div></body></html>